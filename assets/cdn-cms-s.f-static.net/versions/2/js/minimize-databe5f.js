// Run when the page ready (before images and other resource)
jQuery(function($) {var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data-products');var $mainImage = $section.find('.main-image > div');var $productOwlcarousel = $section.find('#productOwlcarousel');if ( $section.length === 0 ) return;jQueryZoomInitialize($mainImage);$productOwlcarousel.owlCarousel({autoPlay: false,items : 4,margin: 10,stagePadding: 5,startPosition: 0,loop: false,center: false,nav: true,rtl: rtl,navText:  [S123.s123IconToSvg.getHtml('angle-'+(rtl ? 'right' : 'left'),'fa-2x'),S123.s123IconToSvg.getHtml('angle-'+(rtl ? 'left' : 'right'),'fa-2x')],dots: true});$productOwlcarousel.find('.item').click(function() {var $clickedImage = $(this).find('.item-image');var videoPath = '';if ($clickedImage.data('media-type') == 'video') {videoPath = $clickedImage.data('video-path');}
jQueryZoomInitialize($clickedImage);$mainImage.css({backgroundImage: $clickedImage.css('background-image')});});function jQueryZoomInitialize( $clickedImage ) {if ( !$mainImage || $mainImage.length === 0 ) return;if ( !$clickedImage || $clickedImage.length === 0 ) return;if ($clickedImage.data('media-type') == 'video' ) {$mainImage.empty();$('<iframe data-player="site123" style="color:white;width:'+ $mainImage.width() +'px;height:'+ $mainImage.height() +'px" type="text/html" src="'+ '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=' + $clickedImage.data('video-path') + (isMobileDevice.any() ? '&autoplay=false': '&autoplay=true' ) +'" frameborder="0" allowfullscreen=""></iframe>').appendTo($mainImage);} else {$mainImage.empty();var url = $clickedImage.data('zoom-image');if ( isMobileDevice.any() ) return;$mainImage.trigger('zoom.destroy');var loading = $('<div style="position:absolute;width:100%;height:100%;z-index:99999;"></div>').appendTo($mainImage);$mainImage.zoom({url: url,magnify: 1,touch: true,callback: function() {loading.remove();},});}}
(function () {var $productOptions = $section.find(".product-options");var $options = $productOptions.find('.p-o-container');if ( $productOptions.length !== 0 ) {$options.filter('[data-type="color"]').each( function() {var $option = $(this);var $colors = $option.find('.p-o-color');$colors.click( function( event ) {var $color = $(this);$colors.filter('.selected').removeClass('selected');$color.addClass('selected');$option.find('.p-o-item-value').html(fixQuotIssue($color.attr('title')));update();});$colors.first().trigger('click');	// default value
});$options.filter('[data-type="list"]').each( function() {var $option = $(this);var $list = $option.find('.p-o-list');$list.change( function( event ) {$option.find('.p-o-item-value').html(fixQuotIssue($list.val()));update();}).trigger('change');	// default value
});update();}
function update() {var po = [];var totalItemsPrice = 0.00;$options.each( function() {var $option = $(this);var pOption = new ProductOptions();pOption.id = $option.get(0).id;pOption.title = fixQuotIssue($option.data('title'));pOption.type = $option.data('type');switch( $option.data('type') ) {case 'color':var $color = $option.find('.p-o-color.selected');if ( $color.length === 0 ) return;pOption.item.id = $color.get(0).id
pOption.item.title = fixQuotIssue($color.attr('title'));pOption.item.price = $color.data('price');break;case 'list':var $list = $option.find('.p-o-list');var $listSelectedOpt = $list.find('option:selected');if ( $list.find('option').length === 0 ) return;pOption.item.id = $listSelectedOpt.get(0).id;pOption.item.title = fixQuotIssue($list.val());pOption.item.price = $listSelectedOpt.data('price');break;}
totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);});$('#productOptions').html(JSON.stringify(po));addItemsPrice(totalItemsPrice);}
function ProductOptions() {return {id: null,title: null,type: null,item: {id: null,title: null,price: 0}};}
function addItemsPrice( totalItemsPrice ) {var $productPrice = $section.find('#productPrice');var $price = $productPrice.find('[data-type="price"]');if ( !$.isNumeric(totalItemsPrice) ) return;if ( parseFloat($productPrice.data('price'))
+ parseFloat(totalItemsPrice) == parseFloat($price.html()) ) return;var p = parseFloat($productPrice.data('price')) + parseFloat(totalItemsPrice);$price.html(p.toFixed(2));}})();(function () {var $ct = $section.find("#product-custom-text");var $ct_fieldTitle = $ct.find("#ct_fieldTitle");var $ct_charLimit = $ct.find("#ct_charLimit");var $orderButtonPopup = $section.find(".orderButtonPopup");$ct_fieldTitle.on('input', function( event ) {var max = $ct.data('char-limit');var length = $ct_fieldTitle.val().length
if ( length > max) {$ct_fieldTitle.val($ct_fieldTitle.val().substring(0, max));} else {$ct_charLimit.html(max - length);}});$ct_fieldTitle.blur( function( event ) {update();});$orderButtonPopup.click( function( event ) {update();});function update() {var ct = new CustomText();ct.fieldTitle = fixQuotIssue($ct.data('field-title'));ct.value = $ct_fieldTitle.val();$('#customText').html(JSON.stringify(ct));}
function CustomText() {return {fieldTitle: null,value: null};}})();function fixQuotIssue( value ) {if ( !value ) return value;return value.toString().replace(/\&quot;/g,'\"');}
$('.quantity_field').on('input', function() {var $this = $(this);if ( $this.val().length > 0 && !$.isNumeric($this.val()) ) $this.val(1);if ( !$.isNumeric($this.val()) ) $this.val($this.val().replace(/[^0-9]/g,''));if ( $.isNumeric($this.val()) && $this.val() <= 0 ) $this.val(1);if ( parseInt($this.val()) > parseInt($this.prop('max')) ) {$this.val($this.prop('max'));quantityPopover($this,translations.productQuntityLimit.replace('{{units_limitation}}',$this.prop('max')));} else if ( parseInt($this.val()) < parseInt($this.prop('min')) ) {$this.val($this.prop('min'));quantityPopover($this,translations.productQuntityLimitMin.replace('{{units_limitation}}',$this.prop('min')));}
$section.find('.btn-buy-now.orderButtonPopup').data('quantity-amount',$this.val());});function quantityPopover( $input, message ) {$input.popover({container: $section,content: message,trigger: 'manual',template: '<div class="popover cart-validator-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: function(popover, input) {return isMobileDevice.any() ? 'auto' : 'bottom';}});$input.popover('show');clearTimeout($input.data('q-p-timeout'));$input.data('q-p-timeout',setTimeout(function(){$input.popover('destroy');},3000));}
function updateQuantity( $input, operator ) {if ( $input.closest('.quantity-container').data('disabled') == '1' ) return;var quantity = parseInt($input.val());var maxQuantity = parseInt($input.attr('max'));var minQuantity = parseInt($input.attr('min'));if ( operator === 'plus' && (quantity + 1) > maxQuantity ) {quantityPopover($input,translations.productQuntityLimit.replace('{{units_limitation}}',$input.prop('max')));} else if ( operator === 'minus' && quantity !== 1 && (quantity - 1) < minQuantity ) {quantityPopover($input,translations.productQuntityLimitMin.replace('{{units_limitation}}',$input.prop('min')));}
if ( operator === 'minus' && quantity > minQuantity ) quantity = quantity - 1;if ( operator === 'plus' && quantity < maxQuantity ) quantity = quantity + 1;if ( !$.isNumeric(quantity) ) quantity = 1;$section.find('.btn-buy-now.orderButtonPopup').data('quantity-amount',quantity);$input.val(quantity);}
$section.find('.quantity-plus-btn').off('click').on('click', function() {updateQuantity($(this).closest('.quantity-container').find('.quantity_field'),'plus');});$section.find('.quantity-minus-btn').off('click').on('click', function() {updateQuantity($(this).closest('.quantity-container').find('.quantity_field'),'minus');});});function SeatMap( settings ) {var _ = {title: settings.title,deviceType: settings.deviceType,dateFUN: settings.dateFUN,endDateFUN: settings.endDateFUN,location: settings.location,tickets: settings.tickets,orderedTickets: settings.orderedTickets,$controller: settings.$controller,cart: [],currency: settings.currency,$seatMap: null,onCheckout: settings.onCheckout,mapObject: settings.seatMapSettings,};_.init = function() {$.each(_.orderedTickets, function( index, orderedTicket ) {let productOptions = tryParseJSON(orderedTicket.productOptions);if ( !productOptions ) {return;}
_.orderedTickets[index] = new SeatMapTicket({isSeatMapTicket: true,ticketID: orderedTicket.item_tool_id,tableLabel: productOptions[0].item.place,tableID: productOptions[0].item.tableID,seatID: productOptions[0].item.id,});});_.orderedTickets = _.orderedTickets.filter(ticket => ticket.isSeatMapTicket);_.$controller.off('click').on('click', function( event ) {event.preventDefault();let $message = $(generateHTML());var $modal = bootbox.dialog({title: `${_.title}`,message: $message,className: `eventSeatMapPopup`,size: 'large',closeButton: true,backdrop: true,show: false,html: true,onEscape: function() {},callback: function () {}})
.on('show.bs.modal', function() {$modal.find('.modal-header').addClass('background-primary-color btn-primary-text-color');$modal.find('.modal-header .bootbox-close-button').addClass('btn-primary-text-color');})
.on('hide.bs.modal', function() {});_.$seatMap = $message.find('#eventSeatMapIframe');_.cart = [];$message.find('#seatMapCheckout').on('click', function( event ) {event.preventDefault();let invalidTickets = isCartValid();if ( Object.keys(invalidTickets).length > 0 ) {$.each(invalidTickets, function( ticketID, info ) {let $ticketElement = $(`#cartItems [data-ticket-id="${ticketID}"] .ticket-body`).first();$ticketElement.popover({container: 'body',content: `${info.count} ticket is selected. the minimum amount is ${info.ticket.minTicketOrder}`,trigger: 'manual',template: '<div class="popover ev-ticket-validator-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: function(popover, input) {return isMobileDevice.any() ? 'auto' : ($('html').attr('dir') === 'rtl' ? 'left' : 'right');}})
.on('show.bs.popover', function(e) {let $this = $(this);$(document).one('mousedown', function(e) {$this.popover('hide');});$ticketElement.get(0).scrollIntoView({behavior: 'smooth',block: 'center'});})
.popover('show');});return;}
if ( _.onCheckout ) _.onCheckout.call(this,_.cart);});$message.find('#seatMapOpenMenu').on('click', function( event ) {event.preventDefault();$('#seatMap').addClass('show-cart');});$('#mobileCloseMenu .sm-close-menu').on('click', function( event ) {event.preventDefault();$('#seatMap').removeClass('show-cart');});$(window).off('message.seatMapTool').on('message.seatMapTool', function( event ) {var data = event.originalEvent.data;switch( data.eventType ) {case 'seatMap.load':_.$seatMap.get(0).contentWindow.postMessage({eventType: 'seatMap.load',orderedTickets: _.orderedTickets,tickets: convertTicketsForMapStructure()});break;case 'seatMap.initMap':_.$seatMap.get(0).contentWindow.postMessage({eventType: 'seatMap.initMap',json: tryParseJSON(_.mapObject),});break;case 'seatMap.getTickets':_.$seatMap.get(0).contentWindow.postMessage({eventType: 'seatMap.loadTicketsList',tickets: convertTicketsForMapStructure()});break;case 'seatMap.chairSelected':if ( data.selectedTicket ) {let parentTypeLabel = '';switch( data.parentType ) {case 'rows':parentTypeLabel = translations.seatMap.row;break;case 'table':case 'round-table':parentTypeLabel = translations.seatMap.table;break;}
const ticket = new SeatMapTicket({color: data.selectedTicket.color,parentID: '',seatFee: 0, // we don't have such feature yet
seatID: data.chairID,tableLabel: data.tableLabel,tableID: data.tableID,parentTypeLabel: parentTypeLabel,ticketID: data.selectedTicket.id,ticketName: data.selectedTicket.title,ticketPrice: MultiCurrencies.getOriginalPrice(data.selectedTicket.price),});if ( _.deviceType == 'computer' ) {if ( _.cart.find( cartTicket => cartTicket.ticketID == ticket.ticketID && cartTicket.tableLabel == ticket.tableLabel && cartTicket.tableID == ticket.tableID && cartTicket.seatID == ticket.seatID  ) ) {removeFromCart(ticket);} else {addToCart(ticket);}
renderCart();} else {if ( _.cart.find( cartTicket => cartTicket.ticketID == ticket.ticketID && cartTicket.tableLabel == ticket.tableLabel && cartTicket.tableID == ticket.tableID && cartTicket.seatID == ticket.seatID  ) ) {removeFromCart(ticket);renderCart();} else {$('#selectedTicketInfo .tk-info-head').html(`
<div class="tk-info-table">
<div>${ticket.parentTypeLabel}</div>
<div>${ticket.tableLabel}</div>
</div>
<div class="tk-info-chair">
<div>Seat</div>
<div>${ticket.seatID}</div>
</div>
<a class="tk-info-cancel" href="#">
${S123.s123IconToSvg.getHtml('times','','')}
</a>
`);$('#selectedTicketInfo .tk-info-body').html(`
<div class="tk-info-name">
${ticket.ticketName}
</div>
<div class="tk-info-price">
${showPrice(_.currency,ticket.ticketPrice)}
</div>
`);$('#selectedTicketInfo .add-to-cart').off('click').on('click', function( event ) {event.preventDefault();addToCart(ticket);renderCart();$('#seatMapView').removeClass('active-ticket');});$('#selectedTicketInfo .tk-info-cancel').on('click', function( event ) {$('#seatMapView').removeClass('active-ticket');_.$seatMap.get(0).contentWindow.postMessage({eventType: 'seatMap.seatUnselected'});});$('#seatMapView').addClass('active-ticket');let ticketInfo = _.tickets.find(tk => tk.id == ticket.ticketID);if ( isCartTicketExceededMaxAmount(ticketInfo) ) {$('#selectedTicketInfo .add-to-cart').addClass('disabled');} else {$('#selectedTicketInfo .add-to-cart').removeClass('disabled');}}}}
break;}});$modal.modal('show');});};function convertTicketsForMapStructure() {let tickets = [];$.each(_.tickets, function( index, ticket ) {let tk = {...ticket,currencyData: MultiCurrencies.isActive ? MultiCurrencies.getActiveCurrency() : _.currency};tk.price = MultiCurrencies.geConvertedPrice(tk.price);tickets.push(tk);});return tickets;}
function generateHTML() {let globalMainColor = getComputedStyle(document.documentElement).getPropertyValue('--global_main_color');let global_main_color_btn_text_color = getComputedStyle(document.documentElement).getPropertyValue('--global_main_color_btn_text_color');return `
<div id="seatMap">
<div id="sideMenu">
<div id="mobileCloseMenu">
<a class="sm-close-menu" href="#">
${S123.s123IconToSvg.getHtml('arrow-left','','')} Back
</a>
</div>
<div id="eventInfo">
<div class="event-info-time">
<div class="event-info-time-label">Time</div>
<div>${_.dateFUN} ${_.endDateFUN ? `- ${_.endDateFUN}` : ''}</div>
</div>
<div class="event-info-location">
<div class="event-info-location-label">Location</div>
<div>${_.location}</div>
</div>
</div>
<div id="cart" class="no-tickets">
<h1 id="cartTitle">
${translations.seatMap.cart}
<span class="cart-counter"></span>
</h1>
<div id="noTicketsContianer">
<h1>${translations.seatMap.emptyCart}</h1>
<span>To add new ticket please select from the map</span>
</div>
<div id="cartItems"></div>
<div id="cartSummery">
<div class="tickets-amount">
<span class="text">{{text}}</span>
<span class="total">{{total}}</span>
</div>
<div class="tickets-total">
<span class="text">${translations.seatMap.total}</span>
<span class="total">{{total}}</span>
</div>
</div>
<a id="seatMapCheckout" href="#" class="btn btn-primary">${translations.seatMap.checkoutBtn}</a>
</div>
</div>
<div id="seatMapView">
<iframe id="eventSeatMapIframe" src="/files/vendor/site123/seatMap/projectFiles/index.php?tranW=${_.$controller.data('website-lang')}&deviceType=${(isMobileDevice.any() ? 'mobile' : 'computer')}&mainColor=${globalMainColor.replace('#','')}&globalMainColorBtnTextColor=${global_main_color_btn_text_color.replace('#','')}" class="iframe" allowfullscreen=""></iframe>
<div class="mobile-tools-container">
<div id="selectedTicketsAmount">
<div class="summery">
<span class="tickets-amount">0 Tickets</span>
<span class="sub-total">${showPrice(_.currency,0)}</span>
</div>
<a id="seatMapOpenMenu" href="#" class="btn btn-primary">View Cart</a>
</div>
<div id="selectedTicketInfo">
<div class="tk-info-head">
</div>
<div class="tk-info-body">
</div>
<div class="tk-info-footer">
<a href="#" class="btn btn-primary add-to-cart">Add To Cart</a>
</div>
</div>
</div>
</div>
</div>
`;}
function renderCart() {$('#cart').addClass('no-tickets');$('#cartItems').empty();$('#cartSummery .tickets-amount .text').html(`${_.cart.length} Tickets`);$('#cartTitle .cart-counter').hide();let subTotal = getCartSubTotal();let cartItemsHeight = 0;if ( _.cart.length > 0 ) {$('#cartTitle .cart-counter').show().text(` (${_.cart.length})`);}
$.each(_.cart, function( elementID, ticket ) {$('#cartItems').append(`
<div id="${ticket.seatID}" data-ticket-id="${ticket.ticketID}" data-seat-id="${ticket.seatID}" data-table-id="${ticket.tableID}" data-type="${ticket.type}" data-parent-id="${ticket.parentID}" class="ticket" style="${$('html[dir="rtl"]').length == 0 ? `border-left: solid 5px ${ticket.color}` : `border-right: solid 5px ${ticket.color}`}">
<div class="ticket-header">
<div>
<div>${ticket.parentTypeLabel}</div>
<div>${ticket.tableLabel}</div>
</div>
<div>
<div>${translations.seatMap.seat}</div>
<div>${ticket.seatID}</div>
</div>
<div>
<a class="remove-ticket" href="#">
${S123.s123IconToSvg.getHtml('trash','','')}
</a>
</div>
</div>
<div class="ticket-body">
<div>
<div>${ticket.ticketName}</div>
<div>${showPrice(_.currency,ticket.ticketPrice)}</div>
</div>
</div>
</div>
`);});if ( _.cart.length > 0 ) {$('#cart').removeClass('no-tickets');$('#cartSummery .tickets-amount .total').html(showPrice(_.currency,subTotal));$('#cartSummery .tickets-total .total').html(showPrice(_.currency,subTotal));$('#cart .ticket .remove-ticket').on('click', function( event ) {event.preventDefault();const $ticket = $(this).closest('.ticket');removeFromCart({ticketID: $ticket.data('ticket-id'),seatID: $ticket.data('seat-id'),tableID: $ticket.data('table-id'),});renderCart();});$('#cartItems').siblings().each(function() {if ( $(this).is(':visible') ) {cartItemsHeight += $(this).outerHeight(true);}});$('#cartItems').attr('style',`height: calc( 100% - ${cartItemsHeight}px );`);}
_.$seatMap.get(0).contentWindow.postMessage({eventType: 'seatMap.cartRendered',cart: _.cart});$('#seatMap .mobile-tools-container .summery .tickets-amount').html(`${_.cart.length} Tickets`);$('#seatMap .mobile-tools-container .summery .sub-total').html(showPrice(_.currency,getCartSubTotal()));$(document).trigger('pageLoaded.multi_currencies');}
function getCartSubTotal() {let subTotal = 0;$.each(_.cart, function( elementID, ticket ) {subTotal += parseFloat(ticket.ticketPrice);});return subTotal;}
function addToCart( ticket ) {let ticketInfo = _.tickets.find(tk => tk.id == ticket.ticketID);if ( isCartTicketExceededMaxAmount(ticketInfo) ) return;_.cart.push(ticket);}
function isCartTicketExceededMaxAmount( ticketInfo ) {return $.isNumeric(ticketInfo.maxTicketOrder) && countTicketInCart(ticketInfo) >= ticketInfo.maxTicketOrder;}
function removeFromCart( ticket ) {for ( var i = 0; i < _.cart.length; i++ ) {if ( _.cart[i].ticketID == ticket.ticketID && _.cart[i].tableID == ticket.tableID && _.cart[i].seatID == ticket.seatID ) {_.cart.splice(i,1);break;}}}
function countTicketInCart( ticketInfo ) {let count = 0;_.cart.forEach(( cartTicket ) => {if ( cartTicket.ticketID == ticketInfo.id ) {count++;}});return count;}
function isCartValid() {let isInvalidTickets = {};$.each(_.tickets, function( index, ticket ) {let cartTicket = _.cart.find( cartTicket => cartTicket.ticketID == ticket.id );if ( cartTicket && $.isNumeric(ticket.minTicketOrder) && countTicketInCart(ticket) < ticket.minTicketOrder ) {isInvalidTickets[ticket.id] = {ticket: ticket,count: countTicketInCart(ticket),};}});return isInvalidTickets;}
function SeatMapTicket( data ) {return Object.assign({color: '',parentID: '',seatFee: 0, // we don't have such feature yet
seatID: '',tableLabel: '',tableID: '',parentTypeLabel: '',ticketID: '',ticketName: '',ticketPrice: '',},data);}
_.init();return _;}jQuery(function($) {var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data.s123-module-events.s123-page-data-events');var $mainImage = $section.find('.main-image > div');var $productOwlcarousel = $section.find('.productOwlcarousel');if ( $section.length === 0 ) return;$productOwlcarousel.owlCarousel({autoPlay: false,items : 4,margin: 10,stagePadding: 5,startPosition: 0,loop: false,center: false,nav: true,rtl: rtl,navText:  [S123.s123IconToSvg.getHtml('angle-'+(rtl ? 'right' : 'left'),'fa-2x',''),S123.s123IconToSvg.getHtml('angle-'+(rtl ? 'left' : 'right'),'fa-2x','')],dots: true});$productOwlcarousel.find('.item').click(function() {var $clickedImage = $(this).find('.item-image');setMainImageVideo($clickedImage);$mainImage.css({backgroundImage: $clickedImage.css('background-image')});});if ($productOwlcarousel.find('.item').length > 0) {$productOwlcarousel.find('.item').eq(0).trigger('click');}
function setMainImageVideo( $clickedImage ) {if ( !$mainImage || $mainImage.length === 0 ) return;if ( !$clickedImage || $clickedImage.length === 0 ) return;$mainImage.empty();if ($clickedImage.data('media-type') == 'video' ) {$('<iframe data-player="site123" style="color:white;width:'+ $mainImage.width() +'px;height:'+ $mainImage.height() +'px" type="text/html" src="'+ '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=' + $clickedImage.data('video-path') + (isMobileDevice.any() ? '&autoplay=false': '&autoplay=true' ) +'" frameborder="0" allowfullscreen=""></iframe>').appendTo($mainImage);}}
googleMapPopUp.init({locationData : $section.find('.mapPopupActivator'),mapsDisplayDomain : $GLOBALS["maps-display-domain"],longFreeCustomer : longFreeCustomer,language : languageCode});$productOwlcarousel.find('.item').click(function() {var $clickedImage = $(this).find('.item-image');$mainImage.css({backgroundImage: $clickedImage.css('background-image')});});initializeTickets($section);});jQuery(function($) {$( document ).on( 's123.page.ready_data_pages', function( event ) {ScheduleBookingInit();});ScheduleBookingInit();});function ScheduleBookingInit() {var $section = $('section.s123-page-data-schedule-booking');if ( $section.length === 0 ) return;bookingInit($section);}jQuery(function($) {var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data-forum');var $postDateTime = $section.find('.post-date-time');var $shareReplyBtn = $section.find('.share-reply-btn');var $topicContainer = $section.find('.topic-container');var $buttonsContainer = $section.find('.reply-buttons-container');var $suggestedTopics = $section.find('.f-suggested-topics');var $mainTopic = $topicContainer.find('.forum-main-topic');var $replies = $topicContainer.find('.f-replies');var itemUniqueID = $topicContainer.data('module-unique-id');var categoryUniqueID = $topicContainer.data('category-id') ? $topicContainer.data('category-id') : '' ;var topicUniqueID = $topicContainer.data('unique-id');var loginURL = $topicContainer.attr('data-login-url');var websiteID = $topicContainer.data('website-id');var dateTime = $topicContainer.data('date-time');var searchURL = $topicContainer.data('search-url');var w = $('#w').val();var replyID = $topicContainer.data('reply-id');var topicURL = $topicContainer.data('topic-url');var customLabels = $('.custom-labels').val();if ( $section.length === 0 ) return;customLabels = jQuery.parseJSON(customLabels);$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/getTopicData.php",data: 'w='+w+'&websiteID='+websiteID+'&uniqueID='+topicUniqueID+'&categoryUniqueID='+categoryUniqueID,success: function( data ) {var dataObj = jQuery.parseJSON(data);dateTime = dataObj.time;$buttonsContainer.each(function(index,buttonContainer) {var $buttonContainer = $(buttonContainer);var replyUniqueID = $buttonContainer.attr('data-reply-id') ? $buttonContainer.data('reply-id') : '';var $html = generateButtonsHTML(websiteID,topicUniqueID,itemUniqueID,dataObj,loginURL,replyUniqueID,index,customLabels);initializeButtons(websiteID,topicUniqueID,categoryUniqueID,$html,topicURL);$buttonContainer.prepend($html);});Forum_updateActivityDateTime(dateTime,$postDateTime);displayEditPostBtn(dateTime,$postDateTime,dataObj);var $sideMenuContainer = generateTopicSideMenu(dataObj,topicUniqueID,$topicContainer,websiteID,topicUniqueID,w,dateTime,itemUniqueID,customLabels,topicURL);$topicContainer.append($sideMenuContainer);var topicsContainersHeight = $('#topicBox').outerHeight(); // OLD CODE: $replies.outerHeight() + $mainTopic.outerHeight();
var sideMenuContainerHeight = $sideMenuContainer.outerHeight();updateSideMenuPosition($sideMenuContainer,topicsContainersHeight,sideMenuContainerHeight);$(window).scroll(function() {updateSideMenuPosition($sideMenuContainer,topicsContainersHeight,sideMenuContainerHeight);});Forum_initializeSearch($section,websiteID,itemUniqueID,searchURL,dateTime);$topicContainer.find('.topic-buttons').append(generateSmallTopicMenu(dataObj,topicUniqueID,$topicContainer,websiteID,topicUniqueID,w,dateTime,searchURL,customLabels));}});shareBtnClickEvent($shareReplyBtn);$section.find('.forum-avatar').each(function(key,value){Forum_initializeClientCard($(value),websiteID,w,itemUniqueID);});Forum_updateActivityDateTime(dateTime, $suggestedTopics.find('.topic-last-activity'));increaseTopicViews(w,websiteID,topicUniqueID);if ( replyID.length > 0 ) {scrollToReply(replyID);}});function scrollToReply( replyID ) {if ( $('#'+replyID).length === 0 ) return;$('html, body').animate({scrollTop: $('#'+replyID).offset().top}, 1000);}
function generateSmallTopicMenu( topicData, topicUniqueID, $topicContainer, websiteID, uniqueID, w, dateTime, searchURL, customLabels) {var html = '<div class="small-menu-container well box-primary hidden-lg hidden-md">';html += '<div class="row small-topic-row">';html += '<div class="col-xs-12 text-center f-small-menu-buttons">';html += '<div class="row">';html += '<div class="btn-group">';html += '<a class="btn btn-primary forum-search-btn" href="'+searchURL+'&q="><span>'+S123.s123IconToSvg.getHtml('search','','')+'</span></a>';html += '</div>';if ( topicData.loggedIn ) {html += '<div class="btn-group">';html += '<button type="button" class="btn btn-primary follow-topic-btn" data-topic-id="'+topicUniqueID+'"><span>'+S123.s123IconToSvg.getHtml('bell-o','','')+'</span><span class="follow-topic-title hidden-xs"> '+customLabels.follow+'</span></button>';html += '</div>';} else {html += '<a class="btn btn-primary" href="'+$topicContainer.data('login-url')+'"><span>'+S123.s123IconToSvg.getHtml('bell-o','','')+'</span><span class="follow-topic-title hidden-xs"> '+customLabels.follow+'</span></a>';}
html += '</div>';html += '</div>';html += '</div>';html += '<div class="row small-topic-row">';html += '<div class="col-xs-6 text-center">';html += '<div class="row">';html += '<div class="col-xs-12">';html += '<span>'+translations.forumLastReply+'</span>';html += '</div>';html += '<div class="col-xs-12">';html += '<div class="last-reply-avatar side-menu-avatar"></div>';html += '<div class="last-reply-time side-menu-time"></div>';html += '</div>';html += '</div>';html += '</div>';html += '<div class="col-xs-6 text-center">';html += '<div class="row">';html += '<div class="col-xs-12">';html += '<span>'+translations.forumReplies+'</span>';html += '</div>';html += '<div class="col-xs-12" style="line-height: 30px;">';html += '<span><b>'+topicData.totalReplies+'</b></span>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';if ( topicData.avatars.length > 0 ) {html += '<div class="row small-topic-row">';html += '<div class="col-xs-12 side-menu-top-line">';html += '<div><span>'+translations.forumFrequentPosters+':</span></div>';html += '<div class="replies-avatars side-menu-avatar"></div>';html += '</div>';html += '</div>';}
html += '</div>';$html = $(html);$html.find('.created-avatar').append(Forum_setAvatar(topicData.ownerAvatar[0].image,100,topicData.ownerAvatar[0].name,topicData.ownerAvatar[0].color));$html.find('.created-avatar').addClass('forum-avatar');$html.find('.created-avatar span').addClass('avatar-img');$html.find('.created-time').append(setCreateTime(topicData.createTime,dateTime));if ( !jQuery.isEmptyObject(topicData.lastReply) ) {$html.find('.last-reply-avatar').append(Forum_setAvatar(topicData.lastReply.avatar[0].image,100,topicData.lastReply.avatar[0].name,topicData.lastReply.avatar[0].color));$html.find('.last-reply-time').append(setCreateTime(topicData.lastReply.createTime,dateTime));} else {$html.find('.last-reply-avatar').html('--');}
var $followReplyBtn = $html.find('.follow-topic-btn');if ( topicData.follower == true ) {$followReplyBtn.addClass('topic-follow');$followReplyBtn.find('.follow-topic-title').html(' '+translations.following);}
$followReplyBtn.click(function() {$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/changeFollowStatus.php",data: 'w='+w+'&websiteID='+websiteID+'&uniqueID='+uniqueID,success: function( data ) {var dataObj = jQuery.parseJSON(data);if ( dataObj.action == 'added' ) {$('section.s123-page-data-forum').find('.follow-topic-btn').addClass('topic-follow');$('section.s123-page-data-forum').find('.follow-topic-title').html(' '+translations.following);} else if ( dataObj.action == 'removed' ) {$('section.s123-page-data-forum').find('.follow-topic-btn').removeClass('topic-follow');$('section.s123-page-data-forum').find('.follow-topic-title').html(' '+customLabels.follow);}}});});var $repliesAvatars = $html.find('.replies-avatars');if ( topicData.avatars.length > 0 ) {$.each (topicData.avatars, function (key, avatar) {$repliesAvatars.append(Forum_setAvatar(avatar.image,100,avatar.name,avatar.color));$(this).addClass('forum-avatar');$(this).find('span').addClass('avatar-img');});}
$html.find('.forum-avatar').each(function(key,value){Forum_initializeClientCard($(value),websiteID,w,uniqueID);});return $html;}
function generateTopicGlobalReply( customLabels ) {return `
<div class="btn-group">
<button type="button" class="btn btn-primary add-reply-btn">${S123.s123IconToSvg.getHtml('reply','','')}</button>
</div>`;}
function generateTopicSideMenu( topicData, topicUniqueID, $topicContainer, websiteID, uniqueID, w, dateTime, itemUniqueID, customLabels, topicURL) {var html = '<div class="container-fluid side-menu-container box-primary s123-box-border side-menu-box hidden-sm hidden-xs">';html += '<div class="row">';html += '<div class="col-xs-12 text-center f-side-menu-buttons">';if ( topicData.loggedIn ) {html += '<div class="btn-group">';html += '<button type="button" class="btn btn-primary follow-topic-btn" data-topic-id="'+topicUniqueID+'"><span>'+S123.s123IconToSvg.getHtml('bell-o','','')+'</span><span class="follow-topic-title hidden-xs"> '+customLabels.follow+'</span></button>';html += '</div>';html += generateTopicGlobalReply(customLabels);} else {html += '<a class="btn btn-primary" href="'+$topicContainer.data('login-url')+'"><span>'+S123.s123IconToSvg.getHtml('bell-o','','')+'</span><span class="follow-topic-title hidden-xs"> '+customLabels.follow+'</span></a>';}
html += '</div>';html += '</div>';html += '<div class="side-menu-created">';html += '<div class="row">';html += '<div class="col-xs-12 side-menu-top-line">';if ( topicData.category.length > 0 ) {html += '<div class="col-xs-6 side-menu-info">';html += '<span>'+translations.category+'</span>';html += '<div><a href=".c/' + topicData.categoryURL + '">' + topicData.category + '</a></div>';html += '</div>';}
html += '<div class="col-xs-6 side-menu-info">';html += '<span>'+translations.created+'</span>';html += '<div>';html += '<div class="created-avatar side-menu-avatar"></div>';html += '<div class="created-time side-menu-time"></div>';html += '</div>';html += '</div>';html += '<div class="col-xs-6 side-menu-info">';html += '<span>'+translations.forumLastReply+'</span>';html += '<div>';html += '<div class="last-reply-avatar side-menu-avatar"></div>';html += '<div class="last-reply-time side-menu-time"></div>';html += '</div>';html += '</div>';html += '<div class="col-xs-6 side-menu-info">';html += '<span>'+translations.forumReplies+'</span>';html += '<div class="col-xs-12" style="line-height: 30px;">';html += '<span><b>'+topicData.totalReplies+'</b></span>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';if ( topicData.avatars.length > 0 ) {html += '<div class="row">';html += '<div class="col-xs-12 side-menu-top-line">';html += '<div><span>'+translations.forumFrequentPosters+':</span></div>';html += '<div class="replies-avatars side-menu-avatar"></div>';html += '</div>';html += '</div>';}
html += '</div>';var $html = $(html);$html.find('.created-avatar').append(Forum_setAvatar(topicData.ownerAvatar[0].image,100,topicData.ownerAvatar[0].name,topicData.ownerAvatar[0].color));$html.find('.created-avatar').addClass('forum-avatar side-menu-popover').attr('data-client-id',topicData.ownerAvatar[0].id);$html.find('.created-time').append(setCreateTime(topicData.createTime,dateTime));if ( !jQuery.isEmptyObject(topicData.lastReply) ) {$html.find('.last-reply-avatar').append(Forum_setAvatar(topicData.lastReply.avatar[0].image,100,topicData.lastReply.avatar[0].name,topicData.lastReply.avatar[0].color));$html.find('.last-reply-avatar span').addClass('forum-avatar side-menu-popover').attr('data-client-id',topicData.lastReply.avatar[0].id);$html.find('.last-reply-time').append(setCreateTime(topicData.lastReply.createTime,dateTime));$html.find('.last-reply-time span').addClass('forum-avatar side-menu-popover').attr('data-client-id',topicData.lastReply.id);} else {$html.find('.last-reply-avatar').html('--');}
var $followReplyBtn = $html.find('.follow-topic-btn');if ( topicData.follower == true ) {$followReplyBtn.addClass('topic-follow');$followReplyBtn.find('.follow-topic-title').html(' '+translations.following);}
$followReplyBtn.click(function() {$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/changeFollowStatus.php",data: 'w='+w+'&websiteID='+websiteID+'&uniqueID='+uniqueID,success: function( data ) {var dataObj = jQuery.parseJSON(data);if ( dataObj.action == 'added' ) {$('section.s123-page-data-forum').find('.follow-topic-btn').addClass('topic-follow');$('section.s123-page-data-forum').find('.follow-topic-title').html(' '+translations.following);} else if ( dataObj.action == 'removed' ) {$('section.s123-page-data-forum').find('.follow-topic-btn').removeClass('topic-follow');$('section.s123-page-data-forum').find('.follow-topic-title').html(' '+customLabels.follow);}}});});var $repliesAvatars = $html.find('.replies-avatars');if ( topicData.avatars.length > 0 ) {$.each (topicData.avatars, function (key, avatar) {var $clientAvatar = Forum_setAvatar(avatar.image,100,avatar.name,avatar.color);$clientAvatar.addClass('forum-avatar side-menu-popover').attr('data-client-id',avatar.id);$repliesAvatars.append($clientAvatar);});}
$html.find('.forum-avatar').each(function(key,value){Forum_initializeClientCard($(value),websiteID,w,itemUniqueID);});replyButtonEvents($html.find('.add-reply-btn'),websiteID,uniqueID,topicURL);return $html;}
function setCreateTime( createTime, dateTime ) {var $html = $('<span></span>');dateTime = new Date(dateTime);var createTime = new Date(createTime);var diff = dateTime - createTime;$html.html(Forum_calcActivityTime(diff,createTime));return $html;}
function shareBtnClickEvent( $shareBtn ) {$shareBtn.click(function() {var $btn = $(this);var url = $btn.data('url');var title = $btn.data('title');var html = generateSharingPopoverHTML('',url,title);sharePopover($btn,html);});}
function generateButtonsHTML( websiteID, topicUniqueID, itemUniqueID, topicData, loginURL, replyUniqueID, index, customLabels) {var html = '';if ( topicData.loggedIn == true ) {if (replyUniqueID=='') {html += '<div class="btn-group">';html += '<button type="button" class="btn btn-sm btn-primary add-reply-btn">'+S123.s123IconToSvg.getHtml('reply','','')+'<span class="hidden-xs"> '+customLabels.reply+'</span></button>';html += '</div>';}
html += '<div class="btn-group edit-btn-container" style="display:none;">';html += '<button type="button" class="btn btn-sm btn-primary edit-btn" data-topic-id="'+topicUniqueID+'" data-reply-id="'+replyUniqueID+'"><span>'+S123.s123IconToSvg.getHtml('pencil','','')+'<span class="hidden-xs"> '+customLabels.edit+'</span></button>';html += '</div>';if ( topicData.manager == true && replyUniqueID.length > 0 ) {html += '<div class="btn-group">';html += '<span class="rmv-reply-btn" data-reply-id="'+replyUniqueID+'">'+S123.s123IconToSvg.getHtml('trash','','')+'</span>';html += '</div>';}} else {if ( topicData.isManagment == true && replyUniqueID.length > 0 ) {html += '<div class="btn-group">';html += '<span class="rmv-reply-btn" data-reply-id="'+replyUniqueID+'">'+S123.s123IconToSvg.getHtml('trash','','')+'</span>';html += '</div>';}
if ( index == '0' ) {var html = '<div class="btn-group">';html += '<a class="btn btn-sm btn-primary new-topic-btn" href="'+loginURL+'">'+S123.s123IconToSvg.getHtml('reply','','')+'<span class="hidden-xs"> '+customLabels.reply+'</span></a>';html += '</div>';}}
$html = $(html);return $html;}
function replyButtonEvents( $addReplyBtn, websiteID, uniqueID, topicURL ) {$addReplyBtn.on('click', function() {buildPopup('popupTopicReply','',buildReplyForm(websiteID,uniqueID,$('#w').val(),''),'',true,false,true,'','');var $popup = $('#popupTopicReply');var $loading = $popup.find('#loading');Forum_froalaEditorInit($popup,true);$popup.find('.replyForm').each( function( index ) {var $form = $(this);$form.validate({errorElement: 'div',errorClass: 'help-block',focusInvalid: true,ignore: ":hidden:not(#message), [contenteditable='true']:not([name])",highlight: function (e) {$(e).closest('.form-group').removeClass('has-info').addClass('has-error');},success: function (e) {$(e).closest('.form-group').removeClass('has-error');$(e).remove();},submitHandler: function( form ) {var $form = $(form);$form.find('button:submit').prop('disabled', true);$form.hide();$loading.show();$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/addReply.php",data: $form.serialize(),success: function( data ) {var dataObj = jQuery.parseJSON(data);$loading.hide();if ( dataObj.status == 'done' ) {$form.trigger("reset");buildPopup_CloseAction('popupTopicReply');if ( dataObj.replyID.length > 0 ) {window.location.href = topicURL + dataObj.replyID;} else {location.reload();}} else {$form.find('button:submit').prop('disabled', false);$form.show();return false;}}});}});});});}
function initializeButtons( websiteID, uniqueID, categoryUniqueID, $html, topicURL ) {var w = $('#w').val();var $addReplyBtn = $html.find('.add-reply-btn');var $rmvReplyBtn = $html.find('.rmv-reply-btn');var $editBtn = $html.find('.edit-btn');var $shareReplyBtn = $html.find('.share-reply-btn');(function(){replyButtonEvents($addReplyBtn,websiteID,uniqueID, topicURL);$editBtn.click(function() {$bth = $(this);postID = $bth.attr('data-reply-id') ? $bth.data('reply-id') : uniqueID ;$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/getContent.php",data: 'w='+w+'&websiteID='+websiteID+'&postID='+postID+'',success: function( data ) {var dataObj = jQuery.parseJSON(data);if ( dataObj.message.length > 0 ) {buildPopup('popupEditTopicReply','',buildReplyForm(websiteID,postID,w,dataObj),'',true,false,true,'','');Forum_ActiveSoftLabelInputs();var $popup = $('#popupEditTopicReply');var $loading = $popup.find('#loading');generatePostCategoriesBox($popup,dataObj);if ( dataObj.subject && dataObj.subject.length > 0 ) {$popup.find('input[name=subject]').focus();Forum_froalaEditorInit($popup,false);} else {Forum_froalaEditorInit($popup,true);}
$popup.find('.replyForm').each( function( index ) {var $form = $(this);$form.validate({errorElement: 'div',errorClass: 'help-block',focusInvalid: true,ignore: ":hidden:not(#message), [contenteditable='true']:not([name])",highlight: function (e) {$(e).closest('.form-group').removeClass('has-info').addClass('has-error');},success: function (e) {$(e).closest('.form-group').removeClass('has-error');$(e).remove();},submitHandler: function( form ) {var $form = $(form);$form.find('button:submit').prop('disabled', true);$form.hide();$loading.show();$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/editPost.php",data: $form.serialize(),success: function( data ) {var dataObj = jQuery.parseJSON(data);if ( dataObj.status == 'done' ) {$form.trigger("reset");$form.find('button:submit').prop('disabled', false);$loading.hide();buildPopup_CloseAction('popupEditTopicReply');location.reload();}}});$form.find('button:submit').prop('disabled', false);$loading.hide();buildPopup_CloseAction('popupEditTopicReply');return false;}});});}}});});if ( $rmvReplyBtn.length === 0 ) return;$rmvReplyBtn.click(function() {var replyUniqueID = $(this).data('reply-id');if ( replyUniqueID.length === 0 ) return;bootbox.confirm({title: '<span class="text-danger"><b>'+translations.forumDeleteReplyTitle+'</b></span>',message: translations.forumDeleteReply,backdrop: true,buttons: {confirm: {label: translations.yes,className: 'btn-danger'},cancel: {label: translations.no,className: 'btn-default'}},callback: function( result ) {if ( !result ) return;$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/forum/rmvReply.php",data: 'w='+w+'&websiteID='+websiteID+'&topicID='+uniqueID+'&replyID='+replyUniqueID+'&categoryUniqueID='+categoryUniqueID,success: function( data ) {var dataObj = jQuery.parseJSON(data);if ( dataObj.status == 'done' ) window.location.reload();}});}});});})();}
function buildReplyForm( websiteID, uniqueID, w, post ) {var direction = $('html').attr('dir') === 'rtl' ? 'right' : 'left';var message = post.message ? post.message : '';var html = '<form class="replyForm" style="max-width: 700px; width: 100%; height: 100%;">';html += '<div class="row">';if ( post.subject && post.subject.length > 0 ) {html += '<div class="col-xs-12">';html += '<div class="form-group softLabel">';html += '<label for="subject">'+translations.insertTopicTitle+'</label>';html += '<input type="text" name="subject" value="'+post.subject+'" class="form-control" required data-msg-required="'+translations.jqueryValidMsgRequire+'" minlength="10" maxlength="255" data-rule-no-spaces-only="true" data-msg-no-spaces-only="'+translations.jqueryValidSpacesOnlyMsg+'">';html += '</div>';html += '</div>';html += '<div class="col-xs-12 categories-list"></div>';}
html += '<div class="col-xs-12" style="text-align:'+direction+';">';html += '<div class="form-group softLabel">';html += '<textarea class="form-control" id="message" name="message" data-editor="froala" data-froala-height="350" data-froala-buttons="about" data-website-id="'+websiteID+'" required data-msg-required="'+translations.jqueryValidMsgRequire+'">'+message+'</textarea>';html += '</div>';html += '</div>';html += '</div>';html += '<button type="submit" class="btn btn-primary btn-block">'+translations.send+'</button>';html += '<input type="hidden" name="w" value="'+w+'">';html += '<input type="hidden" name="websiteID" value="'+websiteID+'">';html += '<input type="hidden" name="postID" value="'+uniqueID+'">';html += '<input type="hidden" name="isTopic" value="'+post.isTopic+'">';html += '</form>';html += '<div id="loading" class="text-center" style="display:none; color:#fff;">';html += S123.s123IconToSvg.getHtml('spinner','fa-spin fa-4x','background-color: #fff;');html += '</div>';return html;}
function displayEditPostBtn( dateTime, $posts, dataObj ) {var oneDay = 24 * 60 * 60 * 1000
dateTime = new Date(dateTime);$posts.each(function (index, post) {var $post = $(post);if ( dataObj.clientID == $post.closest('.post').data('client-id') ) {var postDateTime = new Date($post.data('date-time'));var diff = dateTime - postDateTime;if ( diff < oneDay ) $post.closest('.post').find('.reply-buttons-container .edit-btn-container').show();}});}
function generatePostCategoriesBox( $popup, post ) {var options = '';var hasCategories = false;$.each (post.categories, function (categoryUniqueID, category) {options += '<option value="'+categoryUniqueID+'">'+category.name+'</option>';hasCategories = true;});if ( options.length === 0 ) return;var html = '';html += '<div class="form-group softLabel">';html += '<label for="subject" class="active">'+translations.chooseCategory+'</label>';html += '<select class="form-control" name="categoryUniqueID">';html += options;html += '</select>';html += '</div>';$html = $(html);if ( post.categoryUniqueID ) {$html.find('option[value='+post.categoryUniqueID+']').prop('selected','ture');}
if ( hasCategories ) $popup.find('.categories-list').append($html).show();}
function updateSideMenuPosition( $sideMenu, topicsHeight, sideMenuHeight ) {var windowScrollTop = $(window).scrollTop();if ( windowScrollTop >= topicsHeight-sideMenuHeight ) {$sideMenu.css('top',topicsHeight-sideMenuHeight);} else {$sideMenu.css('top',windowScrollTop);}}
function increaseTopicViews(w,websiteID,topicUniqueID){$.post('/versions/2/wizard/modules/forum/topicViewsAJAX.php', {w: w,websiteID: websiteID,topicUniqueID: topicUniqueID});}jQuery(function($) {$( document ).on( "s123.page.ready_data_pages", function( event ) {storeDataPageInit();});storeDataPageInit();});function storeDataPageInit() {var ProductDataPageGallery = function() {var _ = {galleryID: '',images: [],$container: null,$primaryGallery: null,$secondaryGallery: null,verticalAlbum: false,galleriesSettings: {},rtl: false,};_.pg_init = function( settings ) {_.rtl = settings.rtl;_.verticalAlbum = settings.verticalAlbum;_.galleryRequiredAmount = settings.galleryRequiredAmount;_.galleriesSettings = settings.galleriesSettings;_.$container = settings.$container;};_.pg_render = function( galleryID, images ) {if ( _.galleryID == galleryID ) return;if ( _.galleryID ) _.pg_destroy();_.$primaryGallery = $(`<div id="mainImageSlider" style="${_.galleriesSettings.images_dimension.widthCSS}${_.galleriesSettings.images_dimension.cssRatio}"></div>`);_.$secondaryGallery = $(`<div id="productSlickcarousel"></div>`);$.each(images,function(index,image) {let $secondaryGalleryImage = $(generatetGalleryItemHML(image,index,'secondary'));_.$secondaryGallery.append($secondaryGalleryImage);let $primaryGalleryImage = $(generatetGalleryItemHML(image,index,'primary'));jQueryZoomInitialize($primaryGalleryImage);showGalleryInFullScreenOnClick($primaryGalleryImage,images);_.$primaryGallery.append($primaryGalleryImage);});_.$container.append(_.$primaryGallery);_.$container.append(_.$secondaryGallery);productImageAdjustmentHandler(_.$primaryGallery);calculateMainImagesDimensionForMobile(_.$primaryGallery);secondaryGallery_SliderInit();primaryGallery_SliderInit(images);_.galleryID = galleryID;_.galleryImages = images;};_.pg_destroy = function() {_.$primaryGallery.remove();_.$secondaryGallery.remove();_.galleryID = '';_.galleryImages = [];};_.pg_getImages = function() {return _.galleryImages;};function primaryGallery_SliderInit( images ) {if ( _.$primaryGallery.length === 0 ) {_.$primaryGallery.addClass('product-is-loaded');return;}
if ( images.length <= 1 ) {_.$primaryGallery.addClass('product-is-loaded');return;}
_.$primaryGallery.on('init', function(event, slick) {_.$primaryGallery.addClass('product-is-loaded');});if ( !_.$primaryGallery.hasClass('slick-initialized') ) {_.$primaryGallery.slick({infinite: true,vertical: false,verticalSwiping: _.verticalAlbum,slidesToShow: 1,slidesToScroll: 1,adaptiveHeight: false,rtl: _.rtl,arrows: true,appendArrows: '#'+_.$primaryGallery.get(0).id+' .slick-list',prevArrow: '<button id="#'+_.$primaryGallery.get(0).id+'Prev" class="p-carousel-img-arrow previous" type="button" aria-label="previous"><svg viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50  L 70,10 L 60,0 Z" class="arrow"></path></svg></button>',nextArrow: '<button id="#'+_.$primaryGallery.get(0).id+'Next" class="p-carousel-img-arrow next" type="button" aria-label="next"><svg viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50  L 70,10 L 60,0 Z" class="arrow" transform="translate(100, 100) rotate(180) "></path></svg></button>',fade: true,swipe: isMobileDevice.any() ? true : false,dots: false});}
_.$primaryGallery.on('beforeChange', function( event, slick, currentSlide, nextSlide ) {_.$primaryGallery.data('current-image-index',nextSlide);if ( _.$secondaryGallery.hasClass('slick-initialized') ) {if ( images.length > _.galleryRequiredAmount ) {_.$secondaryGallery.slick('slickGoTo',nextSlide);} else {_.$secondaryGallery.find('.slick-current').removeClass('slick-current');_.$secondaryGallery.find('.slick-slide[data-slick-index="'+nextSlide+'"]').addClass('slick-current');}}});_.$primaryGallery.data('current-image-index',0);if ( _.$primaryGallery.find('.slick-dots li').length > 0 ) {var $firstDot = _.$primaryGallery.find('.slick-dots li').first();var $firstLast = _.$primaryGallery.find('.slick-dots li').last();if ( $firstDot.offset().top != $firstLast.offset().top ) {_.$primaryGallery.addClass('dots-position-fix');}}}
function generatetGalleryItemHML( image, index, type ) {switch ( type ) {case 'primary':return primaryGalleryItem(image,index);break;case 'secondary':return secondaryGalleryItem(image,index);break;}
function primaryGalleryItem( image, index ) {let mediaType, previewImage, zoomImage;if ( image.mediaType && image.mediaType === 'video' ) {mediaType = 'video';if ( image.isExtrenalVideo ) {previewImage = image.t;zoomImage = '';enableZoom = false;} else {previewImage = image.t;zoomImage = '';enableZoom = false;}} else {mediaType = 'image';previewImage = getImageWRV1(800,image.n);zoomImage = getImageWRV1(2000,image.n);enableZoom = _.galleriesSettings.enableAlbumZoom;}
return `
<div class="main-image e-p-mfp-image" style="${_.galleriesSettings.images_dimension.widthCSS}${_.galleriesSettings.images_dimension.cssRatio}" data-ratio="${_.galleriesSettings.imageRatio}" data-enable-album-zoom="${enableZoom}" data-order="${index}" data-mfp-src="${image.n}" data-type="${mediaType}">
${image.mediaType === 'video' ? `
<span class="product-video-icon">
<div class="s123-video-cover">
<span class="s123-video-play-icon">${S123.s123IconToSvg.getHtml('play','','')}</span>
</div>
</span>
` : ''}
${_.galleriesSettings.isShowRibbon ? `
<span class="background-primary-color product-sale-banner">${_.galleriesSettings.ribbonText}</span>
` : !_.galleriesSettings.inStock ? `
<span class="background-primary-color product-out-of-stock">${_.galleriesSettings.outOfStockLabel}</span>
` : ''}
<div data-zoom-image="${zoomImage}" style="background-image: url(${previewImage}); background-position: ${image.focusPoint}"></div>
<span class="image-zoom-btn"></span>
</div>`;}
function secondaryGalleryItem( image, index ) {if ( image.mediaType && image.mediaType === 'video' ) {return `
<div class="item">
<div class="item-image s123-image-ratio-${_.galleriesSettings.imageRatio}" data-media-type="video" data-order="${index}" style="background-image: url(${getImageWRV1(400,image.t)}); background-position: ${image.focusPoint}"></div>
<div class="product-video-icon">
<div class="s123-video-cover">
<span class="s123-video-play-icon v-p-i-xs">${S123.s123IconToSvg.getHtml('play','','')}</span>
</div>
</div>
</div>
`;} else {return `
<div class="item">
<div class="item-image s123-image-ratio-${_.galleriesSettings.imageRatio}" data-media-type="image" data-zoom-image="${getImageWRV1(2000,image.n)}" data-order="${index}" style="background-image: url(${getImageWRV1(800,image.n)}); background-position: ${image.focusPoint}"></div>
</div>`;}}}
function secondaryGallery_SliderInit() {if ( isMobileDevice.any() ) {_.$secondaryGallery.addClass('hidden');return;}
if ( _.$secondaryGallery.children().length === 1 ) {_.$secondaryGallery.hide();_.$secondaryGallery.addClass('product-is-loaded');return;}
_.$secondaryGallery.on('init', function(event, slick){_.$secondaryGallery.addClass('product-is-loaded');});if ( !_.verticalAlbum ) {_.$secondaryGallery.width(_.$primaryGallery.width());}
if ( !_.$secondaryGallery.hasClass('slick-initialized') ) {_.$secondaryGallery.slick({dots: false,infinite: true,vertical: _.verticalAlbum,verticalSwiping: _.verticalAlbum,slidesToShow: _.galleryRequiredAmount,slidesToScroll: 1,adaptiveHeight: false,rtl: _.verticalAlbum ? false : _.rtl,arrows: true,centerMode: false,appendArrows: '#' + _.$secondaryGallery.get(0).id + ' .slick-list',prevArrow: '<button id="' + _.$secondaryGallery.get(0).id + 'Prev" class="p-carousel-img-arrow small-arrow previous" type="button" aria-label="previous"><svg viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50  L 70,10 L 60,0 Z" class="arrow"></path></svg></button>',nextArrow: '<button id="' + _.$secondaryGallery.get(0).id + 'Next" class="p-carousel-img-arrow small-arrow next" type="button" aria-label="next"><svg viewBox="0 0 100 100"><path d="M 10,50 L 60,100 L 70,90 L 30,50  L 70,10 L 60,0 Z" class="arrow" transform="translate(100, 100) rotate(180) "></path></svg></button>',asNavFor: '#'+_.$primaryGallery.get(0).id,focusOnSelect: true});}
_.$secondaryGallery.find('.slick-slide').on('click', function( event ) {_.$secondaryGallery.find('.slick-current').removeClass('slick-current');$(this).addClass('slick-current');_.$primaryGallery.slick('slickGoTo',$(this).data('slickIndex'));});_.$secondaryGallery.find('.item').on('click', function() {var $clickedImage = _.$secondaryGallery.find('.item.slick-current .item-image');if ( $clickedImage.data('media-type') == 'video') {_.$primaryGallery.find('.e-p-mfp-image.slick-active').trigger('click');}});}
function showGalleryInFullScreenOnClick( $image, images ) {$image.on('click',function( event ) {var $product_mfp_gallery = init($image);$product_mfp_gallery.magnificPopup('open',$(this).data('order'));});function init( $product_mfp_gallery ) {$product_mfp_gallery = $('<div class="product-mfp-gallery hidden"></div>').appendTo('body');$.each(images, function( index, image ) {$product_mfp_gallery.append('<div class="e-p-mfp-image" data-mfp-src="'+image.media_path+'" data-type="'+image.mediaType+'"></div>');});$product_mfp_gallery.magnificPopup({fixedContentPos: true,mainClass: 'mfp-e-product-gallery',delegate: '.e-p-mfp-image',							// Categories Filter
closeOnContentClick: true,closeBtnInside: false,tLoading: translations.loading,						// Text that is displayed during loading
gallery: {enabled: true,tClose: translations.closeEsc,					// Alt text on close button
tPrev: translations.previousLeftArrowKey,		// Alt text on left arrow
tNext: translations.NextRightArrowKey,			// Alt text on right arrow
tCounter: '%curr% '+translations.of+' %total%'	// Markup for "1 of 7" counter
},image: {markup: '<div class="mfp-figure">'+'<div class="mfp-close"></div>'+'<div class="mfp-img"></div>'+'<div class="mfp-bottom-bar fancy-scrollbar">'+'<div class="mfp-title"></div>'+'<div class="mfp-counter"></div>'+'<span class="mfp-caption-close">'+S123.s123IconToSvg.getHtml('times','','')+'</span>'+'</div>'+'</div>',titleSrc: 'data-caption',tError: translations.imageCouldNotLoaded		// Error message when image could not be loaded
},iframe: {markup: '<div class="mfp-iframe-scaler">' +'<div class="mfp-close"></div>' +'<iframe class="mfp-iframe" frameborder="0" allowfullscreen></iframe>' +'<div class="mfp-title" style="position: absolute; padding-top: 5px;"></div>' +'</div>',patterns: {youtube: {index: 'youtube.com/',id: function(url) {var matches = url.match(/[\\?\\&]v=([^\\?\\&]+)/);if ( !matches || !matches[1] ) return null;return matches[1];},src: '//www.youtube.com/embed/%id%?autoplay=1'
},vimeo: {index: 'vimeo.com/',id: function(url) {var matches = url.match(/(https?:\/\/)?(www.)?(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/);if ( !matches || !matches[5] ) return null;return matches[5];},src: '//player.vimeo.com/video/%id%?autoplay=1'
},site123: {index: $GLOBALS['cdn-user-videos-files'],id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'},site123Processing: {index: '/files/images/video-processing.png',id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'}}},callbacks: {elementParse: function( item ) {if ( item.el.data('type') === 'video' ) {item.type = 'iframe';} else {item.type = 'image';}},imageLoadComplete: function() {$.each(this.items, function(index, item) {if ( item.type != 'image') return;item.img.attr('alt',productName);});},open: function( item ) {var mc = new Hammer(this.container.get(0));mc.on('swipeleft', function(){$.magnificPopup.instance.next();});mc.on('swiperight', function(){$.magnificPopup.instance.prev();});$product_mfp_gallery.data('hammer-js',mc);$(document).trigger('s123.page.ready.ReplaceExternalLinksInFreeSubDomain');},change: function() {if ( this.isOpen ) {this.wrap.addClass('mfp-open');}},close: function( item ) {$product_mfp_gallery.data('hammer-js').destroy();}}});return $product_mfp_gallery;};}
function jQueryZoomInitialize( $primaryGalleryImage ) {let $image = $primaryGalleryImage.find(' > div');let $clickedImage = $primaryGalleryImage.find(' > div');let $image_zoom_btn = $primaryGalleryImage.find('.image-zoom-btn');let zoom_in_icon = '<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path class="zoom-svg-path" d="M208 48a160 160 0 1 1 0 320 160 160 0 1 1 0-320zm0 368c48.8 0 93.7-16.8 129.1-44.9L471 505c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L371.1 337.1C399.2 301.7 416 256.8 416 208C416 93.1 322.9 0 208 0S0 93.1 0 208S93.1 416 208 416zM184 296c0 13.3 10.7 24 24 24s24-10.7 24-24V232h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H232V120c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"/></svg>';
let zoom_out_icon = '<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path class="zoom-svg-path" d="M208 48a160 160 0 1 1 0 320 160 160 0 1 1 0-320zm0 368c48.8 0 93.7-16.8 129.1-44.9L471 505c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L371.1 337.1C399.2 301.7 416 256.8 416 208C416 93.1 322.9 0 208 0S0 93.1 0 208S93.1 416 208 416zM136 184c-13.3 0-24 10.7-24 24s10.7 24 24 24H280c13.3 0 24-10.7 24-24s-10.7-24-24-24H136z"/></svg>';
if ( $image.length === 0 || $clickedImage.length === 0 || $image_zoom_btn.length === 0 ) return;if ( isMobileDevice.any() || $image.closest('[data-enable-album-zoom="0"]').length > 0 ) {$image_zoom_btn.remove();return;}
$image_zoom_btn.off('click').on('click', function( event ) {event.preventDefault();event.stopPropagation();if ( $primaryGalleryImage.hasClass('zoom-active') ) {$image.trigger('zoom.destroy');$primaryGalleryImage.removeClass('zoom-active');$image_zoom_btn.html(zoom_in_icon);} else {var url = $clickedImage.data('zoom-image');$image.empty();$image.trigger('zoom.destroy');var loading = $('<div style="position:absolute;width:100%;height:100%;z-index:99999;"></div>');$image.zoom({url: url,magnify: 1,touch: true,callback: function() {$(this).attr('alt',productName);loading.remove();},});$primaryGalleryImage.addClass('zoom-active');$image_zoom_btn.html(zoom_out_icon);}});$image_zoom_btn.html(zoom_in_icon);}
return _;}();var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data-eCommerce');var $shareProductBtn = $section.find('.share-product-btn');var storeLabels = tryParseJSON($('.store-labels').val());var originalProductData = tryParseJSON($('.original-product-data').val());var galleriesSettings = tryParseJSON($('#galleriesSettings').val());var getShippingOnPageLoad = true;var galleryRequiredAmount = 4;var verticalAlbum = $('#productGaleries').data('vertical-album') == 1 ? true : false;var productName = $('#productName').val();if ( originalProductData.images && originalProductData.images.length > 0 ) {galleryRequiredAmount = CalculateSlidesToShow(originalProductData.images.length, $('#productGaleries').width(),130,4);}
if ( isMobileDevice.any() && whatScreen.any() === 'mobile' ) {	// `whatScreen` used to prevent tablets
$('#productGaleries').attr('data-vertical-album',0);verticalAlbum = false;}
ProductDataPageGallery.pg_init({rtl: rtl,verticalAlbum: verticalAlbum,$container: $('#productGaleries'),galleriesSettings: galleriesSettings,galleryRequiredAmount: galleryRequiredAmount,});$shareProductBtn.click(function() {var $btn = $(this);var url = $btn.data('url');var title = decodeURIComponent($btn.data('title').replace(/\+/g, ' '));var html = generateSharingPopoverHTML(title,url,title);sharePopover($btn,html);});if ( $section.length === 0 ) return;ProductDataPageGallery.pg_render('productGallery',originalProductData.images);updateAutomaticCouponMsg();(function() {var $relatedProducts = $section.find('.related-products');var $prevArrow = $('<div class="custom-arrow-container custom-slick-prev-container"><a href="javascript:void(0);" class="related-p-c-s-p slick-arrow">'+S123.s123IconToSvg.getHtml('chevron-circle-up','','')+'</a></div>');var $nextArrow = $('<div class="custom-arrow-container custom-slick-next-container"><a href="javascript:void(0);" class="related-p-c-s-n slick-arrow">'+S123.s123IconToSvg.getHtml('chevron-circle-down','','')+'</a></div>');var slidesToShow = findBootstrapColPerRow($relatedProducts);if ( $relatedProducts.children().length <= slidesToShow ) return;$relatedProducts.css({ display: 'flex' });$relatedProducts.parent().prepend($prevArrow);$relatedProducts.parent().append($nextArrow);$relatedProducts.parent().addClass('has-carousel');if ( !$relatedProducts.hasClass('slick-initialized') ) {$relatedProducts.slick({dots: false,infinite: true,vertical: false,verticalSwiping: false,slidesToShow: slidesToShow,slidesToScroll: 1,adaptiveHeight: false,rtl: rtl,prevArrow: '.related-p-c-s-p',nextArrow: '.related-p-c-s-n'});}})();var BackInStock = function() {var _ = {isActve: false,displayName: false,displayPhone: false,$controller: null,messageSettings: {},};_.bs_init = function() {var settings = tryParseJSON($('#backInStock').val());if ( !settings ) return;_.isActve = settings.isActive;_.displayName = settings.displayName;_.displayPhone = settings.displayPhone;_.messageSettings = settings.messageSettings;_.bs_refresh();$(document).off('s123.page.ready.activeOrderPopup.BackInStock').on('s123.page.ready.activeOrderPopup.BackInStock', function( event ) {_.bs_refresh();});};_.bs_refresh = function() {_.$controller = $('.b-s-btn');if ( !_.isActve ) return;_.$controller.off('click').on('click.BackInStock', function( event ) {event.preventDefault();buildPopup('popupBackToStock','',generateHTML(),'',true,false,true,'','');$('#popupBackToStock').find('.popupBackToStockForm').each( function( index ) {var $form = $(this);var forms_GoogleRecaptcha = new Forms_GoogleRecaptcha();forms_GoogleRecaptcha.init($form);$form.validate({errorElement: 'div',errorClass: 'help-block',focusInvalid: true,ignore: "",highlight: function (e) {$(e).closest('.form-group').removeClass('has-info').addClass('has-error');},success: function (e) {$(e).closest('.form-group').removeClass('has-error');$(e).remove();},submitHandler: function( form ) {var $form = $(form);if ( forms_GoogleRecaptcha.isActive && !forms_GoogleRecaptcha.isGotToken ) {forms_GoogleRecaptcha.getToken();return false;}
$form.find('button:submit').prop('disabled',true);if ( IsManagment == '2' ) {formSuccessAction($form,forms_GoogleRecaptcha,translations.backInStock.message);} else {$.ajax({type: "POST",url: "/versions/"+$('#versionNUM').val()+"/wizard/modules/eCommerce/backInStock/requestO.php",data: $form.serialize(),success: function( data ) {data = tryParseJSON(data);formSuccessAction($form,forms_GoogleRecaptcha,data.message);WizardNotificationUpdate();}});}
return false;}});});});_.$controller.attr('disabled',false);_.$controller.text(_.messageSettings.title).addClass('b-s-btn');};_.bs_destroy = function() {_.$controller.off('click.BackInStock');};function formSuccessAction( $form, forms_GoogleRecaptcha, message ) {$form.trigger("reset");forms_GoogleRecaptcha.reset();$form.addClass("hidden");$('.bSConfirmation').removeClass('hidden');$('.bSConfirmation .thankYouMessage').text(message);$form.next().find('.close-order-thank-you').on("click",function() {buildPopup_CloseAction('popupBackToStock');});$form.find('button:submit').prop('disabled', false);}
function generateHTML() {var html = '';html += '<form class="popupBackToStockForm">';html += '<div class="container-fluid">';html += '<div class="row">';html += '<div class="col-xs-12 col-sm-7 col-sm-offset-3">';html += '<h2 class="text-center">'+escapeHtml(translations.backInStock.title)+'</h2>';html += '</div>';html += '<div class="col-xs-12 col-sm-7 col-sm-offset-3">';html += '<p class="text-center">'+escapeHtml(_.messageSettings.description)+'</p>';html += '</div>';html += '<div class="col-xs-12 col-sm-7 col-sm-offset-3">';if ( _.displayName ) {html += '<div class="form-group">';html += '<label for="name" class="white">'+escapeHtml(translations.backInStock.name)+'</label>';html += '<input type="text" name="name" placeholder="'+escapeHtml(translations.backInStock.namePlaceHolder)+'" class="form-control" required data-msg-required="'+escapeHtml(translations.jqueryValidMsgRequire)+'">';html += '</div>';}
if ( _.displayPhone ) {html += '<div class="form-group">';html += '<label for="phone" class="white">'+escapeHtml(translations.backInStock.phone)+'</label>';html += '<input type="text" name="phone" placeholder="'+escapeHtml(translations.backInStock.phonePlaceHolder)+'" class="form-control" required data-msg-required="'+escapeHtml(translations.jqueryValidMsgRequire)+'">';html += '</div>';}
html += '<div class="form-group">';html += '<label for="email" class="white">'+escapeHtml(translations.emailAddress)+'</label>';html += '<input type="text" name="email" placeholder="'+escapeHtml(translations.emailAddress)+'" class="form-control" required data-msg-required="'+escapeHtml(translations.jqueryValidMsgRequire)+'" data-rule-email="true" data-msg-email="'+escapeHtml(translations.jqueryValidMsgEmail)+'">';html += '</div>';html += '<button type="submit" class="btn btn-primary btn-block">'+escapeHtml(translations.send)+'</button>';html += '</div>';html += '</div>';html += '</div>';html += '<input type="hidden" name="w" value="'+$('#w').val()+'">';html += '<input type="hidden" name="websiteID" value="'+$('#websiteID').val()+'">';html += '<input type="hidden" name="productID" value="'+$('.product-data-obj').data('unique-id')+'">';html += '<input type="hidden" name="language" value="'+languageCode+'">';html += '<input type="hidden" name="tranW" value="'+websiteLanguageCountryFullCode+'">';html += '<input type="hidden" name="recaptchaToken" value="">';html += '</form>';html +='<div class="bSConfirmation hidden">';html += '<div class="container-fluid">';html += '<div class="row">';html += '<div class="col-xs-12 col-sm-7 col-sm-offset-3">';html += '<div class="form-group">';html += '<label class="white thankYouMessage text-center"></label>';html += '</div>';html += '</div>';html += '</div>';html += '<div class="row">';html += '<div class="col-xs-12 col-sm-7 col-sm-offset-3">';html += '<button type="button" class="btn btn-primary btn-block close-order-thank-you">'+escapeHtml(translations.Ok)+'</button>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';return html;}
_.bs_init();return _;}();(function () {var $productOptions = $section.find(".product-options");var $options = $productOptions.find('.p-o-container');let productOptions = tryParseJSON(originalProductData.productOptions);if ( $productOptions.length !== 0 ) {$options.filter('[data-type="color"]').each( function() {var $option = $(this);var $colors = $option.find('.p-o-color');$colors.click( function( event ) {var $color = $(this);var title = $color.attr('title');if ( $color.hasClass('selected') && !$option.data('mandatory') == 1 ) {$colors.filter('.selected').removeClass('selected');title = '';} else {$colors.filter('.selected').removeClass('selected');$color.addClass('selected');}
setMainProductImage();$option.find('.p-o-item-value').html(fixQuotIssue(title));update();disableRelatedProductOptions($color.get(0).id);hideLastOptionOfDisabledVariants();$(document).trigger('s123.productOptions.selected');});if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectDefaultItem($option);}
setMainProductImage();});$options.filter('[data-type="radio"]').each( function() {var $option = $(this);var $radios = $option.find('.p-o-radio');$radios.click( function( event ) {var $radio = $(this);var title = $radio.attr('title');if ( $radio.hasClass('selected') && !$option.data('mandatory') == 1 ) {$radios.filter('.selected').removeClass('selected');$radio.prop('checked',false);title = '';} else {$radios.filter('.selected').removeClass('selected');$radio.addClass('selected');}
setMainProductImage();$option.find('.p-o-item-value').html(fixQuotIssue(title));update();hideLastOptionOfDisabledVariants();$(document).trigger('s123.productOptions.selected');});if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectDefaultItem($option);}
setMainProductImage();});$options.filter('[data-type="checkbox"]').each( function() {var $option = $(this);var $checkboxes = $option.find('.p-o-checkbox');$checkboxes.off('click').click( function( event ) {var $checkbox = $(this);$checkbox.hasClass('selected') ? $checkbox.removeClass('selected') : $checkbox.addClass('selected');var itemValue = Array();$checkboxes.filter('.selected').each(function() {itemValue.push(fixQuotIssue($(this).attr('title')));});$option.find('.p-o-item-value').html(itemValue.join(','));setMainProductImage();update();hideLastOptionOfDisabledVariants();$(document).trigger('s123.productOptions.selected');});if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectDefaultItem($option);}
setMainProductImage();});$options.filter('[data-type="size"]').each( function() {var $option = $(this);var $sizes = $option.find('.p-o-size');$sizes.click( function( event ) {var $size = $(this);var title = $size.attr('title');if ( $size.hasClass('selected') && !$option.data('mandatory') == 1 ) {$sizes.filter('.selected').removeClass('selected');title = '';} else {$sizes.filter('.selected').removeClass('selected');$size.addClass('selected');}
setMainProductImage();$option.find('.p-o-item-value').html(fixQuotIssue(title));update();disableRelatedProductOptions($size.get(0).id);hideLastOptionOfDisabledVariants();$(document).trigger('s123.productOptions.selected');});if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectDefaultItem($option);}
setMainProductImage();});$options.filter('[data-type="list"]').each( function() {var $option = $(this);var $list = $option.find('.p-o-list');$list.change( function( event ) {$list.find('option').removeClass('selected');$list.find('option:selected').addClass('selected');setMainProductImage();$option.find('.p-o-item-value').html(fixQuotIssue($list.val()));update();disableRelatedProductOptions($list.find('option:selected').get(0).id);hideLastOptionOfDisabledVariants();$(document).trigger('s123.productOptions.selected');});if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectDefaultItem($option);}
setMainProductImage();});$options.filter('[data-type="textArea"]').each( function() {var $option = $(this);var $textArea = $option.find('.p-o-textArea');$textArea.on('input', function( event ) {update();});});$options.filter('[data-type="textField"]').each( function() {var $option = $(this);var $textField = $option.find('.p-o-textField');$textField.on('input', function( event ) {update();});});$options.filter('[data-type="numbersField"]').each( function() {var $option = $(this);var $numbersField = $option.find('.p-o-numbersField');$numbersField.on('input', function( event ) {if ( !$.isNumeric($(this).val()) ) $(this).val($(this).val().replace(/[^0-9]/g,''));update();});});$options.filter('[data-type="datePicker"]').each( function() {var $option = $(this);var $datePicker = $option.find('.fake-input.p-o-datePicker');var $hiddenInput = $option.find('[data-id="'+$datePicker.data('related-id')+'"]');var $datePickerIcon = $option.find('.p-o-datePicker-icon');var calendar = new calendar_handler();calendar.init({$fakeInput: $datePicker,$hiddenInput: $hiddenInput,$fakeInputIcon: $datePickerIcon,type: 'datePicker',title: translations.chooseDate,calendarSettings: {format: $datePicker.data('date-format'),weekStart: 0,todayBtn: "linked",clearBtn: false,language: languageCode,todayHighlight: true},onSubmit: function( selectedDate ) {$datePicker.html(selectedDate);$hiddenInput.val(selectedDate);update();}});});$options.filter('[data-type="timePicker"]').each( function() {var $option = $(this);var $timePicker = $option.find('.fake-input.p-o-timePicker');var $hiddenInput = $option.find('[data-id="'+$timePicker.data('related-id')+'"]');var $datePickerIcon = $option.find('.p-o-timePicker-icon');var calendar = new calendar_handler();calendar.init({$fakeInput: $timePicker,$hiddenInput: $hiddenInput,$fakeInputIcon: $datePickerIcon,type: 'timePicker',title: translations.chooseTime,onSubmit: function( selectedTime ) {$timePicker.html(selectedTime);$hiddenInput.val(selectedTime);update();}});});$options.filter('[data-type="dateTimePicker"]').each( function() {var $option = $(this);var $dateTimePicker = $option.find('.fake-input.p-o-date-timePicker');var $hiddenInput = $option.find('[data-id="'+$dateTimePicker.data('related-id')+'"]');var $datePickerIcon = $option.find('.p-o-date-timePicker-icon');var calendar = new calendar_handler();calendar.init({$fakeInput: $dateTimePicker,$hiddenInput: $hiddenInput,$fakeInputIcon: $datePickerIcon,type: 'dateTimePicker',title: translations.chooseDateAndTime,calendarSettings: {format: $dateTimePicker.data('date-format'),weekStart: 0,todayBtn: "linked",clearBtn: false,language: languageCode,todayHighlight: true},onSubmit: function( selectedDate, selectedTime ) {$dateTimePicker.html(selectedDate + ' ' + selectedTime);$hiddenInput.val(selectedDate + ' ' + selectedTime);update();}});});$options.filter('[data-type="uploadFile"]').each( function() {var $option = $(this);var $uploadFile = $option.find('.p-o-uploadFile');$uploadFile.on('change', function( event ) {update();});});update();disableRelatedProductOptions(null, true);if ( !S123.QueryString.options ) {updateProductOptionOnPageLoad();}
hideLastOptionOfDisabledVariants();$(document).off('s123.productOptions.selected').on('s123.productOptions.selected',function( event ) {let selectedItemsIDS = collectActiveOptions();let url = new URL(window.location.href);let params = new URLSearchParams(url.search);params.set('options',selectedItemsIDS.join(','));window.history.pushState({},'',`${url.pathname}?${params}`);});if ( window.history && window.history.pushState ) {let selectedItemsOnLoad = collectActiveOptions();$(window).on('popstate', function() {initS123QueryString();$('.product-options .p-o-container:is([data-type="color"],[data-type="radio"],[data-type="size"],[data-type="checkbox"],[data-type="list"])').each( function()
{let $option = $(this);$option.find('.selected').removeClass('selected');$option.find('input[type="checkbox"],input[type="radio"]').prop('checked',false);$option.find('option').prop('selected',false);if ( S123.QueryString.options ) {selectItemFromURL($option,S123.QueryString.options.split(','));} else {selectItemFromURL($option,selectedItemsOnLoad);}});update();disableRelatedProductOptions(null, true);updateProductOptionOnPageLoad();hideLastOptionOfDisabledVariants();});}
function collectActiveOptions() {let selectedItemsIDS = [];$('.product-options .selected').each(function() {$this = $(this);if ( !$this.get(0).id ) return;selectedItemsIDS.push($this.get(0).id);});return selectedItemsIDS;}}
function update() {var po = [];var totalItemsPrice = 0.00;const productVariants = JSON.parse($('#productVariants').val());let productOptionsWithVariants = [];if ( productVariants.optionsConstantOrderForVariants ) {$options.each(function( index, option ) {var $option = $(this);if ( ['textArea', 'textField', 'numbersField', 'datePicker', 'timePicker', 'dateTimePicker', 'uploadFile', 'checkbox'].includes($option.data('type')) ) return;if ( productVariants.optionsConstantOrderForVariants.indexOf(option.id) == -1 ) {productVariants.optionsConstantOrderForVariants.push(option.id);}});$.each(productVariants.optionsConstantOrderForVariants, function( index, optionID ) {let $option = $options.filter('#'+optionID);if ( $option.length > 0 ) {productOptionsWithVariants.push($option.get(0));}});} else {$options.filter(function() {var $option = $(this);var optionType = $option.data('type');var noItemsOptionTypes = ['textArea', 'textField', 'numbersField', 'datePicker', 'timePicker', 'dateTimePicker', 'uploadFile', 'checkbox'];return noItemsOptionTypes.indexOf(optionType) === -1;}).sort(function(firstOption, secondOption) {return $(firstOption).get(0).id.localeCompare($(secondOption).get(0).id);}).each(function( index, option ) {productOptionsWithVariants.push(option);});}
$options.filter(function() {var $option = $(this);var optionType = $option.data('type');var noItemsOptionTypes = ['textArea', 'textField', 'numbersField', 'datePicker', 'timePicker', 'dateTimePicker', 'uploadFile', 'checkbox'];return noItemsOptionTypes.indexOf(optionType) !== -1;}).each( function() {var $option = $(this);var pOption = new ProductOptions();pOption.id = $option.get(0).id;pOption.title = fixQuotIssue($option.data('title'));pOption.type = $option.data('type');switch( $option.data('type') ) {case 'textField':var $textField = $option.find('.p-o-textField');if ( $textField.length === 0 ) return;pOption.item.id = $textField.get(0).id;pOption.item.value = fixQuotIssue($textField.val());pOption.item.price = $textField.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'numbersField':var $numbersField = $option.find('.p-o-numbersField');if ( $numbersField.length === 0 ) return;pOption.item.id = $numbersField.get(0).id;pOption.item.value = fixQuotIssue($numbersField.val());pOption.item.price = $numbersField.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'uploadFile':var $uploadFile = $option.find('.p-o-uploadFile');if ( $uploadFile.length === 0 || $uploadFile.val().length === 0 ) return;pOption.item.id = $uploadFile.get(0).id;pOption.item.value = fixQuotIssue($uploadFile.val());pOption.item.price = $uploadFile.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'textArea':var $textArea = $option.find('.p-o-textArea');if ( $textArea.length === 0 ) return;pOption.item.id = $textArea.get(0).id;pOption.item.value = fixQuotIssue($textArea.val());pOption.item.price = $textArea.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'datePicker':var $datePicker = $option.find('.p-o-datePicker');if ( $datePicker.length === 0 ) return;pOption.item.id = $datePicker.get(0).id;pOption.item.value = fixQuotIssue($option.find('[data-id="'+$datePicker.data('related-id')+'"]').val());pOption.item.price = $datePicker.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'timePicker':var $timePicker = $option.find('.p-o-timePicker');if ( $timePicker.length === 0 ) return;pOption.item.id = $timePicker.get(0).id;pOption.item.value = fixQuotIssue($option.find('[data-id="'+$timePicker.data('related-id')+'"]').val());pOption.item.price = $timePicker.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'dateTimePicker':var $dateTimePicker = $option.find('.p-o-date-timePicker');if ( $dateTimePicker.length === 0 ) return;pOption.item.id = $dateTimePicker.get(0).id;pOption.item.value = fixQuotIssue($option.find('[data-id="'+$dateTimePicker.data('related-id')+'"]').val());pOption.item.price = $dateTimePicker.data('price');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'radio':var $radio = $option.find('.p-o-radio.selected');if ( $radio.length === 0 ) return;pOption.item.id = $radio.get(0).id;pOption.item.title = fixQuotIssue($radio.attr('title'));pOption.item.price = $radio.data('price');pOption.item.imgSrc = $radio.data('image-src');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'checkbox':var $checkboxes = $option.find('.p-o-checkbox.selected');$.each($checkboxes, function( index, checkbox ) {pOption = new ProductOptions();pOption.id = $option.get(0).id;pOption.title = fixQuotIssue($option.data('title'));pOption.type = $option.data('type');pOption.item.id = $(this).get(0).id;pOption.item.title = fixQuotIssue($(this).attr('title'));pOption.item.price = $(this).data('price');pOption.item.imgSrc = $(this).data('image-src');po.push(pOption);totalItemsPrice += parseFloat(pOption.item.price);});break;}});$.each(productOptionsWithVariants, function( index, option ) {var $option = $(option);var pOption = new ProductOptions();pOption.id = $option.get(0).id;pOption.title = fixQuotIssue($option.data('title'));pOption.type = $option.data('type');pOption.required = $option.find('.p-o-required').length > 0;switch( $option.data('type') ) {case 'color':var $color = $option.find('.p-o-color.selected');if ( $color.length === 0 ) return;pOption.item.id = $color.get(0).id;pOption.item.title = fixQuotIssue($color.attr('title'));pOption.item.price = $color.data('price');pOption.item.imgSrc = $color.find('[data-zoom-image]').data('image-src');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'list':var $list = $option.find('.p-o-list');var $listSelectedOpt = $list.find('option:selected');if ( $list.find('option').length === 0 || !$listSelectedOpt.get(0).id ) return;pOption.item.id = $listSelectedOpt.get(0).id;pOption.item.title = fixQuotIssue($list.val());pOption.item.price = $listSelectedOpt.data('price');pOption.item.imgSrc = $listSelectedOpt.data('image-src');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'size':var $size = $option.find('.p-o-size.selected');if ( $size.length === 0 ) return;pOption.item.id = $size.get(0).id;pOption.item.title = fixQuotIssue($size.attr('title'));pOption.item.price = $size.data('price');pOption.item.imgSrc = $size.find('[data-zoom-image]').data('image-src');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;case 'radio':var $radio = $option.find('.p-o-radio.selected');if ( $radio.length === 0 ) return;pOption.item.id = $radio.get(0).id;pOption.item.title = fixQuotIssue($radio.attr('title'));pOption.item.price = $radio.data('price');pOption.item.imgSrc = $radio.find('[data-zoom-image]').data('image-src');totalItemsPrice += parseFloat(pOption.item.price);po.push(pOption);break;}
if ( ProductDataPageGallery.galleryID == pOption.item.id ) {let gallery = ProductDataPageGallery.pg_getImages();if ( gallery.length > 0 ) {pOption.item.galleryFirstImage = gallery[0].n;}}});const productOptions = {'options': po,'variant': {}}
if (productVariants.active) {productOptions.variant = updateVariants(po);} else {addItemsPrice(totalItemsPrice)}
$('#productOptions').val(JSON.stringify(productOptions));$productOptions.trigger('po.update');}
function disableRelatedProductOptions(optionId, onPageLoad) {resetDisableProductOptionsVariants();const productVariants = JSON.parse($('#productVariants').val());if(productVariants.active) {for (let index = 0; index < productVariants.items.length; index++) {const variant = productVariants.items[index];const variantsOptionsId = splitVariantOptionsId(variant.optionsId);if(optionId) {const indexOfOptionId = variantsOptionsId.indexOf(optionId);if ( indexOfOptionId !== -1 ) {if ( !isVariantInStock(variant) ) {variantsOptionsId.splice(indexOfOptionId, 1);disableProductOptionsVariants(variantsOptionsId, 'out of stock');}}}
if(onPageLoad) {if(!variant.active) {disableProductOptionsVariants(variantsOptionsId);}}}}}
function hideLastOptionOfDisabledVariants() {$options.find('.p-o-v-invisible').removeClass('p-o-v-invisible');var productVariants = tryParseJSON($('#productVariants').val());for (let index = 0; index < productVariants.items.length; index++) {if ( productVariants.items[index].active ) continue;var unSelectedItems = [];var variantsOptionsId = splitVariantOptionsId(productVariants.items[index].optionsId);for (var i = 0; i < variantsOptionsId.length; i++) {var $option = $('#'+variantsOptionsId[i]);if ( !$option.hasClass('selected') ) {unSelectedItems.push($option);}}
if ( unSelectedItems.length == 1 ) {unSelectedItems[0].closest('.po-item').addClass('p-o-v-invisible');}}}
function updateVariants(selectedOptions) {const productVariants = JSON.parse($('#productVariants').val());var optionsIds = [];selectedOptions.forEach(function(option) {if (['textArea','textField','numbersField','datePicker','timePicker','dateTimePicker','uploadFile', 'checkbox'].indexOf(option.type) != -1 ) return;if (!option.required) return;if ( productVariants.optionsConstantOrderForVariants && !productVariants.optionsConstantOrderForVariants.includes(option.id) ) {return;}
optionsIds.push(option.item.id);});if(optionsIds.length < 1) return {};var optionsId = optionsIds.join('-');if(optionsId.length === 0) return {};let filteredVariants = productVariants.items.filter(function(variant) { return variant.optionsId === optionsId });if(filteredVariants.length === 0) return {};const selectedVariant = filteredVariants[0];if(selectedVariant && !$.isNumeric(selectedVariant.inventory)) {const inStock = selectedVariant.inventory === 'in stock' ? true : false;if(!inStock || !selectedVariant.active) {setProductOutOfStock(optionsIds);} else {setProductInStock();}} else {setQuantityMax(selectedVariant, optionsIds);}
if(selectedVariant && selectedVariant.sku) {setProductSku(selectedVariant.sku);} else {setProductSku();}
var price = addItemsPrice(selectedVariant.charge);var newWeightAndPrice = getWeightAndPrice(price,selectedVariant.weight);getShippingOnPageLoad = false;getShippingInfo(newWeightAndPrice.price,newWeightAndPrice.weight);return selectedVariant;}
function getWeightAndPrice( price, weight ) {originalProductData.weight = $.isNumeric(originalProductData.weight) ? originalProductData.weight : 0;weight = $.isNumeric(weight) ? weight : 0;return {price: price,weight: parseFloat(weight) + parseFloat(originalProductData.weight)};}
function updateProductOptionOnPageLoad() {const productOptions = JSON.parse($('#productOptions').val());const productVariants = JSON.parse($('#productVariants').val());const variant = productOptions.variant;if(Object.keys(variant).length === 0) return;if($.isNumeric(variant.inventory)) {if (variant.inventory > 0 && variant.active && productVariants.active) return;} else {if (variant.inventory === 'in stock' && variant.active && productVariants.active) return;}
const otherVariants = productVariants.items
.filter(function(productVariant) {return productVariant.optionsId !== variant.optionsId;});$.each(otherVariants,function(index, variant) {if ( !variant.active ) return;if ( $.isNumeric(variant.inventory) ) {if ( variant.inventory === 0 ) return;} else {if ( variant.inventory === 'out of stock' ) return;}
const variantOptionsId = splitVariantOptionsId(variant.optionsId)
variantOptionsId.forEach(function(optionsId) {disableRelatedProductOptions(optionsId, true);$options.each(function() {const $option = $(this);switch( $option.data('type') ) {case 'color':const $colors = $option.find('.p-o-color');const $color = $option.find('.p-o-color#' + optionsId);if($color.length !== 0) {$colors.filter('.selected').removeClass('selected');$color.addClass('selected');$color.trigger('click');$option.find('.p-o-item-value').html(fixQuotIssue($color.attr('title')));}
break;case 'radio':const $radios = $option.find('.p-o-radio');const $radio = $option.find('.p-o-radio#' + optionsId);if($radio.length !== 0) {$radios.filter('.selected').removeClass('selected');$radio.addClass('selected');$radio.trigger('click');$option.find('.p-o-item-value').html(fixQuotIssue($radio.attr('title')));}
break;case 'checkbox':const $checkboxes = $option.find('.p-o-checkbox');const $checkbox = $option.find('.p-o-checkbox#' + optionsId);if($checkbox.length !== 0) {$checkboxes.filter('.selected').removeClass('selected');$checkbox.addClass('selected');$option.find('.p-o-item-value').html(fixQuotIssue($checkbox.attr('title')));}
break;case 'size':const $size = $option.find('.p-o-size#' + optionsId);if ( $size.length !== 0 ) {$size.attr('selected', true);$size.trigger('click');$option.find('.p-o-item-value').html(fixQuotIssue($size.attr('title')));}
break;case 'list':const $list = $option.find('.p-o-list');const $listSelectedOpt = $list.find('option#' + optionsId);if ( $listSelectedOpt.length !== 0 ) {$listSelectedOpt.attr('selected', true);$listSelectedOpt.trigger('change');$option.find('.p-o-item-value').html(fixQuotIssue($listSelectedOpt.val()));}
break;}});});update();return false;});}
function splitVariantOptionsId(optionsId) {return optionsId.split('-')
.filter(function(v) {return v !== 'poi';}).map(function(id) {return 'poi-' + id;});}
function setProductSku(value) {if(!value) {value = $section.find('#productSku').data('sku');}
$section.find('#productSku').html(value);}
function setQuantityMax( selectedVariant, optionsIds ) {const quantity = selectedVariant.inventory;if ( quantity > 0 ) {if ( $('.quantity_field').val() > quantity ) {$('.quantity_field').val(quantity);$section.find('.btn-buy-now.orderButtonPopup').data('quantity-amount',quantity);}
$('.quantity_field').attr('max', quantity);if ( !selectedVariant.active ) {setProductOutOfStock(optionsIds);} else {setProductInStock(optionsIds);}} else {setProductOutOfStock(optionsIds);$('.quantity_field').attr('max', 1);}}
function setProductOutOfStock(optionsIds) {const $orderButtonPopup = $section.find(".orderButtonPopup");if( $('.product-sale-banner').length !== 0 ) $('.product-sale-banner').hide();if($('.product-out-of-stock').length === 0) {$('.main-image').prepend('<span class="btn btn-primary product-out-of-stock">' + storeLabels.outOfStock + '</span>');}
$orderButtonPopup.attr('disabled', true);$orderButtonPopup.addClass('a-o-out-of-stock');$orderButtonPopup.text(storeLabels.outOfStock);$orderButtonPopup.addClass('b-s-btn');BackInStock.bs_refresh();}
function setProductInStock(optionsIds) {if( $('.product-sale-banner').length !== 0 ) $('.product-sale-banner').show();const $orderButtonPopup = $section.find(".orderButtonPopup");if($('.product-out-of-stock').length !== 0) {$('.product-out-of-stock').remove();}
$orderButtonPopup.attr('disabled', false);$orderButtonPopup.removeClass('a-o-out-of-stock');$orderButtonPopup.text(storeLabels.addToCart);$orderButtonPopup.removeClass('b-s-btn');BackInStock.bs_destroy();ActiveOrderPopup.initializeAddToCart();}
function disableProductOptionsVariants(productOptionsId, type) {var className = type === 'out of stock' ? 'p-o-v-out-of-stock' : 'p-o-v-hidden'
for (let index = 0; index < productOptionsId.length; index++) {const optionId = productOptionsId[index];$options.find('#' + optionId).addClass(className);}}
function resetDisableProductOptionsVariants() {$options.each(function() {$option = $(this);$option.find('.p-o-v-out-of-stock').removeClass('p-o-v-out-of-stock');})}
function isVariantInStock(variant) {if(variant && !$.isNumeric(variant.inventory)) {const inStock = variant.inventory === 'in stock' ? true : false;return inStock;} else {if(!variant.active || variant.inventory <= 0) {return false;} else {return true;}}}
function ProductOptions() {return {id: null,title: null,type: null,item: {id: null,title: null,price: 0,imgSrc : ''}};}
function addItemsPrice( totalItemsPrice ) {var $productPrice = $section.find('#productPrice');var $price = $productPrice.find('[data-type="price"]');if ( !$.isNumeric(totalItemsPrice) ) return parseFloat($price.html());if ( parseFloat($productPrice.data('price')) + parseFloat(totalItemsPrice) == parseFloat($price.html()) ) return parseFloat($price.html());var p = parseFloat($productPrice.data('price')) + parseFloat(totalItemsPrice);$price.html(p.toFixed(2));$(document).trigger('multi_currencies_price_update',[[{el: $productPrice,newPrice: p.toFixed(2)}]]);if ( $section.find('#priceBeforeSale').length !== 0 ) {var $priceBeforeSale = $section.find('#priceBeforeSale');var $price = $priceBeforeSale.find('[data-type="price"]');var pbs = parseFloat($priceBeforeSale.data('price')) + parseFloat(totalItemsPrice);$price.html(pbs.toFixed(2));var psp = ((1-(parseFloat(p)/parseFloat(pbs)))*100).toFixed(2);psp = Number(psp);$('.price-sale-precentege').html('(-'+psp+'%)');$(document).trigger('multi_currencies_price_update',[[{el: $priceBeforeSale,newPrice: pbs.toFixed(2)}]]);}
$('.product-details').data('product-price',p);return p;}
function setMainProductImage() {let poiID = '';let optionItemGallery = '';$productOptions.find('.po-item.selected, .po-item .selected').each(function() {let $selectedItem = $(this);let $option = $selectedItem.closest('.p-o-container');optionItemGallery = productOptions.custom[$option.get(0).id].items[$selectedItem.get(0).id].gallery;if ( optionItemGallery.length > 0 ) {poiID = $selectedItem.get(0).id;return false;}});if ( optionItemGallery.length > 0 ) {ProductDataPageGallery.pg_render(poiID,optionItemGallery);} else {ProductDataPageGallery.pg_render('productGallery',originalProductData.images);}}
function selectDefaultItem( $option ) {if ( !$option.data('default-item') ) return;var $defItem = $option.find('#'+$option.data('default-item'));var title = $defItem.attr('title');if ( $defItem.is('input[type="checkbox"]') || $defItem.is('input[type="radio"]') ) {$defItem.prop('checked',true);} else if ( $defItem.is('option') ) {$defItem.prop('selected',true);title = $defItem.val();}
$defItem.addClass('selected');$option.find('.p-o-item-value').html(fixQuotIssue(title));}
function selectItemFromURL( $option, optionsArray ) {$option.find('.selected').removeClass('selected');$option.find('input[type="checkbox"],input[type="radio"]').prop('checked',false);$option.find('option').prop('selected',false);$.each(optionsArray, function(index, itemID) {let $item = $option.find(`#${itemID}`);if ( $item.length == 0 ) return;if ( ['color','size'].includes($option.data('type')) && $option.find('.po-item.selected').length > 0 ) return;var title = $item.attr('title');if ( $item.is('input[type="checkbox"]') || $item.is('input[type="radio"]') ) {$item.prop('checked',true);} else if ( $item.is('option') ) {$item.prop('selected',true);title = $item.val();}
$item.addClass('selected');$option.find('.p-o-item-value').html(fixQuotIssue(title));});var $selecedOption = $option.find('.selected');if ( $selecedOption.length > 0 ) {setMainProductImage();}}})();function fixQuotIssue( value ) {if ( !value ) return value;return value.toString().replace(/\&quot;/g,'\"');}
$('.quantity_field').on('input', function() {var $this = $(this);if ( $this.val().length > 0 && !$.isNumeric($this.val()) ) $this.val(1);if ( !$.isNumeric($this.val()) ) $this.val($this.val().replace(/[^0-9]/g,''));if ( $.isNumeric($this.val()) && $this.val() <= 0 ) $this.val(1);if ( parseInt($this.val()) > parseInt($this.prop('max')) ) {$this.val($this.prop('max'));quantityPopover($this,translations.productQuntityLimit.replace('{{units_limitation}}',$this.prop('max')));} else if ( parseInt($this.val()) < parseInt($this.prop('min')) ) {$this.val($this.prop('min'));quantityPopover($this,translations.productQuntityLimitMin.replace('{{units_limitation}}',$this.prop('min')));}
$section.find('.btn-buy-now.orderButtonPopup').data('quantity-amount',$this.val());});$section.find('.quantity-plus-btn').off('click').on('click', function() {updateQuantity($(this).closest('.quantity_container').find('.quantity_field'),'plus');});$section.find('.quantity-minus-btn').off('click').on('click', function() {updateQuantity($(this).closest('.quantity_container').find('.quantity_field'),'minus');});$section.find('.p-o-guide').each(function( index, guide ) {let $guide = $(guide);let guideSettings = {displayName: $guide.find('.p-o-guide-title').text(),description: $guide.find('.p-o-guide-content').html(),};$guide.on('click', function( event ) {event.preventDefault();var html = '';html += '<div class="bootbox modal fade po-guide-modal" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">';html += '<div class="modal-dialog" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true">×</button>';html += '<h3 class="modal-title text-center">' + S123.escapeHtml(guideSettings.displayName) + '</h3>';html += '</div>';html += '<div class="modal-body">';html += '<div class="bootbox-body">';html += guideSettings.description;html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';var $html = $(html);$('.product-container').append($html);$html.one('hidden.bs.modal', function (e) {$html.remove();});$html.modal('show');});});function quantityPopover( $input, message ) {$input.popover({container: $section,content: message,trigger: 'manual',template: '<div class="popover cart-validator-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: function(popover, input) {return isMobileDevice.any() ? 'auto' : 'top';}});$input.popover('show');clearTimeout($input.data('q-p-timeout'));$input.data('q-p-timeout',setTimeout(function(){$input.popover('destroy');},3000));}
function updateQuantity( $input, operator ) {if ( $input.closest('.quantity_container').data('disabled') == '1' ) return;var quantity = parseInt($input.val());var maxQuantity = parseInt($input.attr('max'));var minQuantity = parseInt($input.attr('min'));if ( operator === 'plus' && (quantity + 1) > maxQuantity ) {quantityPopover($input,translations.productQuntityLimit.replace('{{units_limitation}}',$input.prop('max')));} else if ( operator === 'minus' && quantity !== 1 && (quantity - 1) < minQuantity ) {quantityPopover($input,translations.productQuntityLimitMin.replace('{{units_limitation}}',$input.prop('min')));}
if ( operator === 'minus' && quantity > minQuantity ) quantity = quantity - 1;if ( operator === 'plus' && quantity < maxQuantity ) quantity = quantity + 1;if ( !$.isNumeric(quantity) ) quantity = 1;$section.find('.btn-buy-now.orderButtonPopup').data('quantity-amount',quantity);$input.val(quantity);}
(function() {function boughtTogetherPlugin() {var bt = this;this.init = function( settings ) {bt.$container = settings.$container;bt.currency = tryParseJSON(settings.currency);bt.updatePackagePrice();bt.addCheckboxEvent();};this.addCheckboxEvent = function() {var $btCheck = bt.$container.find('.b-t-check:checked');$btCheck.on('click', function() {var $this = $(this);if ( $this.is(':checked') ) {bt.$container.find('.b-t-product-box[data-unique-id="'+$this.val()+'"]').fadeIn();bt.$container.find('.b-t-plus-box[data-unique-id="'+$this.val()+'"]').fadeIn();} else {bt.$container.find('.b-t-product-box[data-unique-id="'+$this.val()+'"]').fadeOut();bt.$container.find('.b-t-plus-box[data-unique-id="'+$this.val()+'"]').fadeOut();}
bt.updatePackagePrice();});};this.updatePackagePrice = function() {var $btCheck = bt.$container.find('.b-t-check:checked');var $packagePrice = bt.$container.find('.package-price');var price = 0;var products = [];$.each($btCheck, function( index, checkBox ) {var $this = $(this);price += parseFloat($this.data('price'));products.push($this.val());});$packagePrice.data('price',price);$packagePrice.html(showPrice(bt.currency,price.toFixed(2)));bt.$container.find('.orderButtonPopup').data('multi-products',JSON.stringify(products));$(document).trigger('multi_currencies_price_update',[[{el: $packagePrice,newPrice: price.toFixed(2)}]]);};}
var bt = new boughtTogetherPlugin();bt.init({$container : $section.find('.bought-together-plugin'),currency: $section.find('#boughtTogetherCurrency').html()});})();(function productPageTabsInit() {var $firstTab = $section.find('.product-page-tabs').children().first();$firstTab.addClass('active');$($firstTab.find('a').attr('href')).addClass('active in');if ( $section.find('a[data-toggle="tab"]').length == 1 ) {$firstTab.find('a').trigger('click');}})();function getShippingInfo( price, weight ) {if ( $('#productShipping').length == 0 ) return;var weightMeasurement = $('#productShipping').data('weight');var lengthMeasurement = $('#productShipping').data('length');function addPopUp( shipping ) {var html = '';html += '<ul class="list-unstyled">';html += '<li>';html += '<button type="button" class="close">&times;</button>';html += '</li>';$.each(shipping.shipping.options, function( index, option ) {html += '<li>';html += '<div class="form-group">';html += '<label>' + escapeHtml(option.title) + '</label>';html += '<br>';if ( option.deliveryTime ) {html += '<span>' + shipping.productData.translations.deliveryTime + ' ' + escapeHtml(option.deliveryTime) + '</span>';}
if ( option.formattedRate ) {html += '<br>';html += '<span>' + shipping.productData.translations.estimatedPrice + ' ' + option.formattedRate + '</span>';}
html += '</div>';html += '</li>';});if ( shipping.storePickup ) {html += '<li>';html += '<div class="form-group">';html += '<label>' + escapeHtml(shipping.storePickup.title) + '</label>';html += '<div>';if ( shipping.storePickup.deliveryTime ) {html += '<span>' + shipping.productData.translations.message + ' ' + escapeHtml(shipping.storePickup.deliveryTime) + '</span>';html += '<br>';}
html += '<span>' + translations.address + ' ' + escapeHtml(shipping.storePickup.address) + '</span>';html += '<br>';html += '<span>' + translations.city + ' ' + escapeHtml(shipping.storePickup.city) + '</span>';html += '<br>';html += '<span>' + translations.state + ' ' + escapeHtml(shipping.storePickup.state) + '</span>';html += '<br>';html += '<span>' + translations.zipCode + ' ' + escapeHtml(shipping.storePickup.zipCode) + '</span>';html += '<br>';html += '<span>' + translations.country_v2 + ' ' + escapeHtml(shipping.storePickup.country) + '</span>';html += '</div>';html += '<div>';html += '<span>' + translations.instructions + ' ' + escapeHtml(shipping.storePickup.instructions) + '</span><br>';html += '</div>';html += '</div>';html += '</li>';}
if ( hasWeightAndDimensions(shipping.productData) ) {html += '<li>';html += '<label>' + shipping.productData.translations.additionalData + '</label>';html += '</li>';if ( shipping.productData.weight && $.isNumeric(shipping.productData.weight) ) {html += '<li>';html += '<span>' + shipping.productData.translations.weight + '</span>&nbsp;';html += shipping.productData.weight+' <span class="measurement-unit">'+weightMeasurement+'</span>';html += '</li>';}
if ( shipping.productData.length && $.isNumeric(shipping.productData.length) ) {html += '<li>';html += '<span>' + shipping.productData.translations.length + '</span>&nbsp;';html += shipping.productData.length+' <span class="measurement-unit">'+lengthMeasurement+'</span>';html += '</li>';}
if ( shipping.productData.width && $.isNumeric(shipping.productData.width) ) {html += '<li>';html += '<span>' + shipping.productData.translations.width + '</span>&nbsp;';html += shipping.productData.width+' <span class="measurement-unit">'+lengthMeasurement+'</span>';html += '</li>';}
if ( shipping.productData.height && $.isNumeric(shipping.productData.height) ) {html += '<li>';html += '<span>' + shipping.productData.translations.height + '</span>&nbsp;';html += shipping.productData.height+' <span class="measurement-unit">'+lengthMeasurement+'</span>';html += '</li>';}}
html += '</ul>';var $seeMore = $('<a href="javascript:void(0);" class="see-more">' + shipping.productData.translations.seeMoreLink + ' </a>');$seeMore.on('click', function() {var $btn = $(this);showMoreEvent($btn,html);});$('#productShipping').append($seeMore);}
function hasWeightAndDimensions( productData ) {if ( productData.weight || productData.length || productData.width || productData.height ) return true;return false;}
function showMoreEvent( $button, html ) {var $html = $(html);$button.popover({container: $('.product-container'),html: 'true',content: $html,trigger: 'manual',template: '<div class="popover shipping-options" role="tooltip" style="max-width: 100%;"><div class="arrow"></div><div class="popover-content"></div></div>',placement: function(popover, button) {return !isMobileDevice.any() ? 'auto' : 'top';}});$button.popover('show');$button.on('shown.bs.popover', function () {$html.find('button').on('click', function(){destroySharePopover();});$(document).on('mousedown.showMoreDestroyPopover', function ( event ) {if ( $(event.target).closest('.popover.shipping-options').length === 0 ) {destroySharePopover();}});});function destroySharePopover() {$button.popover('destroy');$(document).off('mousedown.showMoreDestroyPopover');$(window).off('blur.showMoreDestroyPopover');$(window).off('scroll.showMoreDestroyPopover');}}
(function addShippingInfoToPage() {$.post('/versions/2/wizard/modules/eCommerce/getSingleProductShippingOptionsAjax.php', {w : $('#w').val(),websiteID : $('#websiteID').val(),tranW : websiteLanguageCountryFullCode,moduleID : 112,uniqueID : $('#productShipping').data('unique-id'),moduleTypeNUM : 112,price : price,weight : weight}).done(function( shipping ) {$('#productShipping').find('.first-option').empty();$('#productShipping').find('.see-more').remove();shipping = tryParseJSON(shipping);var html ='';if ( !shipping.noShippingAvalible ) {var firstOption = shipping.shipping.options[Object.keys(shipping.shipping.options)[0]];var deliveryTime = escapeHtml(firstOption.deliveryTime) ? ' (' + escapeHtml(firstOption.deliveryTime) + ') ' : ' ';var isFreeShipping = shipping.region.method === 'freeShipping';var hasSeeMore = false;delete shipping.shipping.options[Object.keys(shipping.shipping.options)[0]];if ( isFreeShipping ) {$('#productShipping').find('.first-option').addClass('free-shipping');firstOption.formattedRate = '';$('#productShipping .shipping-title').hide();}
html = escapeHtml(firstOption.title) + deliveryTime + firstOption.formattedRate + ' ';if ( Object.keys(shipping.shipping.options).length > 0 ) hasSeeMore = true;if ( hasWeightAndDimensions(shipping.productData) ) hasSeeMore = true;if ( hasSeeMore ) {addPopUp(shipping);}} else {html += shipping.message;if ( !shipping.isStorePickup ) {$('#productShipping').find('.first-option').addClass('no-shipping');}}
$('#productShipping').find('.first-option').append(html);$(document).trigger('multi_currencies_price_update',[[{el: $('#productShipping').find('.first-option'),newPrice: parseFloat($('#productShipping').find('.first-option [data-type="price"]').html()).toFixed(2)}]]);$('#productShipping').addClass('shipping-loaded');});})();}
if ( getShippingOnPageLoad ) {getShippingInfo(originalProductData.price,originalProductData.weight);}
(function() {if ( $('.product-return-policy[data-more="1"]').length == 0 ) return;var html = '';html += '<div class="bootbox modal fade r-p-m" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">';html += '<div class="modal-dialog" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true">×</button>';html += '<h4 class="modal-title">' + S123.escapeHtml(translations.returnPolicy) + '</h4>';html += '</div>';html += '<div class="modal-body">';html += '<div class="bootbox-body">';html += $('.return-policy.original-text').val();html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';var $html = $(html);$('.product-container').append($html);var $seeMore = $('<a href="javascript:void(0);" class="see-more">' + S123.escapeHtml(translations.seeMore) + '</a>');$seeMore.on('click', function() {var $btn = $(this);$html.modal('show');});$('.product-return-policy[data-more="1"]').closest('li').append($seeMore);})();function escapeHtml( text ) {if ( !text ) return text;var map = {'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#039;'};return text.toString().replace( /[&<>"']/g, function( m ) { return map[m]; } );}
function calculateMainImagesDimensionForMobile( $mainImage ) {if ( $mainImage.length === 0 || !isMobileDevice.any() || whatScreen.any() !== 'mobile' ) return;var ratio = $section.find('.main-image').data('ratio');var split_ratio = ratio.split('-');var ratio_width = split_ratio[0];var ratio_height = split_ratio[1];var aspect_ratio = parseFloat(ratio_height) / parseFloat(ratio_width);var width = screen.width - 30;var height = (parseFloat(width) * parseFloat(aspect_ratio)).toFixed(2);$section.find('.main-image').css({width: width,height: height,});$mainImage.css({width: width,height: height,});}
(function() {var Review = new Comments_Initialize({id: 'productPageReview',type: 1,onLoad: function( reviews, reviewAvg, newReview ) {if ( reviews == 0 ) {Review_DataPage.hideReview();} else {Review_DataPage.showReview();}
Review_DataPage.addReviewAvgToPage(reviewAvg,reviews);if ( newReview ) {var $newReview = $('#commentsContainer .commentBox[data-comment-id="'+Review_DataPage.newReviewID+'"]');if ( $newReview.length > 0 ) {Review_DataPage.focusUserOnNewReview();}}},onFormSubmit: function( newReviewID, blockComment ) {if ( blockComment ) {Review_DataPage.showManagerApproveMessage();Review_DataPage.newReviewID = null;} else {Review_DataPage.newReviewID = newReviewID;Review_DataPage.hideModal();}}});var Review_DataPage = function() {var that = this;that.init = function() {that.$reviewTabLink = $('#reviewsTabLink');that.$reviewTabContent = $('#reviews');that.$form = $('#productPageReview .commentsForm');that.newReviewID = null;if ( that.$form.length === 0 ) return;that.$modal = $('<div class="bootbox modal fade review-pop-up" tabindex="-1" role="dialog" aria-hidden="false" style="display: none; padding-right: 17px;"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><button type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true" style="margin-top: -10px;">×</button><div class="bootbox-body"><div id="reviewFormContainer"></div><div id="reviewAutoConfirmMsg">'+translations.productReviewMessage+'</div></div></div></div></div></div>');that.$modal.find('.bootbox-body #reviewFormContainer').append(that.$form);$('body').append(that.$modal);that.$addNewReview = $section.find('.addNewReview');that.$addNewReview.on('click', function() {that.$modal.modal('show');that.showReviewForm();});var html = '';html += '<div class="review-sum">';html += S123.s123IconToSvg.getHtml('spinner','fa-spin','');html += '</div>';$section.find('.review-container').prepend(html);};that.addReviewAvgToPage = function( reviewAvg, reviews ) {var $reviewContainer = $section.find('.review-container');that.generateStarsHtml(reviewAvg);$reviewContainer.find('.review-sum').html(that.generateStarsHtml(reviewAvg)+' <span>' + reviews + '</span>');$reviewContainer.find('.addNewReview').show();};that.generateStarsHtml = function( reviewAvg ) {var html = '';var num = parseInt(reviewAvg);var decimal = (reviewAvg - Math.floor(reviewAvg)) *10;var addHalfStar = decimal > 0;for ( var i = 1; i <= 5 ; i++ ) {if ( i <= num ) {html += S123.s123IconToSvg.getHtml('star','','');} else if ( i > num && addHalfStar ) {html += S123.s123IconToSvg.getHtml('star-half-o','','');addHalfStar = false;} else {html += S123.s123IconToSvg.getHtml('star-o','','');}
html += '&nbsp;';}
return html;};that.hideReview = function() {var $tabsContainer = $section.find('.tabs-container');var $tabLinks = $tabsContainer.find('.product-page-tabs');var $tabs = $tabsContainer.find('.tab-content');$tabs.find('#reviews').addClass('hidden');$tabLinks.find('#reviewsTabLink').parent().addClass('hidden');$tabLinks.children(':not(.hidden)').first().find('a').trigger('click');if ( !$section.find('.product-page-tabs').children().is(':visible') ) $tabsContainer.addClass('hidden');};that.showReview = function() {var $tabsContainer = $section.find('.tabs-container');var $tabLinks = $tabsContainer.find('.product-page-tabs');var $tabs = $tabsContainer.find('.tab-content');$tabs.find('#reviews').removeClass('hidden');$tabLinks.find('#reviewsTabLink').parent().removeClass('hidden');$tabsContainer.removeClass('hidden');};that.hideModal = function() {if ( !that.$modal ) return;that.$modal.modal('hide');};that.showManagerApproveMessage = function() {that.$modal.find('#reviewFormContainer').fadeOut(function() {that.$modal.find('#reviewAutoConfirmMsg').fadeIn();});};that.showReviewForm = function() {that.$modal.find('#reviewAutoConfirmMsg').hide();that.$modal.find('#reviewFormContainer').show();};that.focusUserOnNewReview = function() {if ( that.$reviewTabContent.is(':visible') ) {scrollToReview();} else {that.$reviewTabLink.one('shown.bs.tab', function() {scrollToReview();}).trigger('click');}
function scrollToReview() {var offset = findBootstrapEnvironment() != 'xs' ? menuScrollOffset : menuScrollOffset_mobile;$('html, body').stop().animate({scrollTop: ($('#commentsContainer .commentBox[data-comment-id="'+that.newReviewID+'"]').offset().top - offset)},600);}};return that;}();Review_DataPage.init();})();function productImageAdjustmentHandler( $mainImage ) {let $product_images = $('.product-images');let $main_images = $mainImage.find('.main-image');let album_style = $product_images.data('style');if ( parseInt(album_style) === 1 ) {$mainImage.add($main_images).css({width: '100%'});} else {$mainImage.css({width: 'calc(100% - 120px)'});$main_images.css({width: '100%'});}
let natural_width = $main_images.width();let natural_height = $main_images.height();let max_height = 500;if ( parseInt(album_style) !== 1 ) {max_height = 750;}
if ( natural_height > max_height ) {let newWidth = (max_height / natural_height) * natural_width;$mainImage.add($main_images).css({width: newWidth + 'px',height: max_height + 'px'});} else {$main_images.css({width: '100%'});}}
function updateAutomaticCouponMsg() {var $priceContainer = $section.find('.price-container');var $productAutomaticCouponLoading = $section.find('.product-automatic-coupon-loading');if ( $productAutomaticCouponLoading.length == 0 ) return;$.ajax({type: 'POST',url: '/versions/' + $('#versionNUM').val() + '/wizard/orders/front/getAutomaticCouponMsg.php',data: {w: $('#w').val(),websiteID: $(websiteID).val(),total: $productAutomaticCouponLoading.data('price'),cartType: $productAutomaticCouponLoading.data('cart-type'),couponApplyTo: 'products',settings: {isOnSale: $productAutomaticCouponLoading.data('is-on-sale'),salePrice: $productAutomaticCouponLoading.data('sale-price'),displayPriceBeforeSale: $productAutomaticCouponLoading.data('display-price-before-sale'),displayDiscountLabel: $productAutomaticCouponLoading.data('display-discount-label'),uniqueID: $productAutomaticCouponLoading.data('unique-id'),}},success: function( response ) {if ( response != '' ) {$priceContainer.html('').append(response);$(document).trigger('pageLoaded.multi_currencies');}
$productAutomaticCouponLoading.hide();$priceContainer.removeClass('hidden');}});}
$section.find('.product-subscription-pricing-types').find('.product-subscription-radio').on('click',function( event ) {$section.find('.product-subscription-pricing-types').find('.product-subscription-radio').removeClass('checked');$(this).addClass('checked');$(this).find(`#${$(this).data('id')}`).prop("checked", true);$section.find('.product-subscription-error').remove();});}
function CalculateSlidesToShow(totalImages, containerWidth, slideWidth, desiredSlidesToShow) {if ( totalImages <= desiredSlidesToShow ) {return desiredSlidesToShow;}
let maxSlidesInContainer = Math.floor(containerWidth / slideWidth);let adjustedSlidesToShow = Math.min(desiredSlidesToShow, maxSlidesInContainer);if (totalImages < adjustedSlidesToShow) {adjustedSlidesToShow = Math.max(1, totalImages);}
return adjustedSlidesToShow;}// Run when the page ready (before images and other resource)
jQuery(function($) {$(document).on('s123.page.ready_data_pages', function(event) {blogAutomaticLinkBuilding();blogCommentsInit();});blogAutomaticLinkBuilding();blogCommentsInit();});function blogCommentsInit() {var $section = $('section.s123-page-data-blog');if ( $section.length === 0 ) return;if ( isMobileDevice.any() && whatScreen.any() == 'mobile' && $('#itemPageComments').length != 0 ){$('#itemPageComments').insertBefore($('.related-post-container'));$('<div class="clearfix" style="margin-top:20px;"></div>').insertAfter($('#itemPageComments'));}
if ( $('#itemPageComments').length > 0 ) {$(window).on('scroll.displayComment', function() {if ( $('#itemPageComments').length == 0 ) return;var elementPosition = $('#itemPageComments').offset().top;if ( $(window).scrollTop() >= (elementPosition - $(window).height() - 300) ) {$(window).off('scroll.displayComment');var Comments = new Comments_Initialize({id: 'itemPageComments',type: 0,customLabels: customLabels ? customLabels : {},});}});}}
function blogAutomaticLinkBuilding() {var $section = $('section.s123-page-data-blog');if ( $section.length === 0 ) return;var $automaticLinksList = $section.find('#automaticLinksList');var isMultipleReplaces = false;if (  $automaticLinksList.length === 0 ) return;var keywords = tryParseJSON($automaticLinksList.val());if ( $section.data('is-multiple-replaces') ) {isMultipleReplaces = true;}
keywords = sortKeywords(keywords);$('.s123-editor').html(automaticLinkBuilding($('.s123-editor').html(), keywords));function automaticLinkBuilding(content, keywords) {var tempDiv = $('<div>').html(content);tempDiv.contents().each(function() {processTextNodes(this);});return tempDiv.html();}
function processTextNodes(node) {if (node.nodeType === Node.TEXT_NODE) {var text = node.nodeValue;var newText = text;for (var keyword in keywords) {if ( keywords[keyword].length == 0 ) continue;var regex = new RegExp('(?<!<a[^>]*>)(?<!\\S)' + keyword + '(?!\\S)(?![^<]*</a>)', 'giu');newText = newText.replace(regex, function(match) {if ( keywords[keyword].length == 0 ) return match;var link = '<a href="' + keywords[keyword] + '">' + match + '</a>';if ( !isMultipleReplaces ) keywords[keyword] = '';return link;});}
if (newText !== text) {$(node).replaceWith(newText);}} else {if (node.nodeType === Node.ELEMENT_NODE && !$(node).is('img') && !$(node).is('a') && !$(node).is('h1') && !$(node).is('h2') && !$(node).is('h3') && !$(node).is('iframe')) {$(node).contents().each(function() {processTextNodes(this);});}}}
function tryParseJSON( str ) {try {var Obj = JSON.parse(str);if ( Obj && typeof Obj === "object" ) {return Obj;}} catch (e) {}
return false;}
function sortKeywords( keywords ) {var sortedKeywords = Object.entries(keywords);sortedKeywords.sort((a, b) => b[0].length - a[0].length);return Object.fromEntries(sortedKeywords);}}// Run when the page ready (before images and other resource)
jQuery(function($) {$(document).on('s123.page.ready_data_pages', function(event) {articleAutomaticLinkBuilding();articleCommentsInit();});articleAutomaticLinkBuilding();articleCommentsInit();});function articleCommentsInit() {var $section = $('section.s123-page-data-articles');if ( $section.length === 0 ) return;if ( isMobileDevice.any() && whatScreen.any() == 'mobile' && $('#itemPageComments').length != 0 ){$('#itemPageComments').insertBefore($('.related-article-container'));$('<div class="clearfix" style="margin-top:20px;"></div>').insertAfter($('#itemPageComments'));}
if ( $('#itemPageComments').length > 0 ) {$(window).on('scroll.displayComment', function() {var elementPosition = $('#itemPageComments').offset().top;if ( $(window).scrollTop() >= (elementPosition - $(window).height() - 300) ) {$(window).off('scroll.displayComment');var Comments = new Comments_Initialize({id: 'itemPageComments',type: 0,customLabels: customLabels ? customLabels : {},});}});}}
function articleAutomaticLinkBuilding() {var $section = $('section.s123-page-data-articles');if ( $section.length === 0 ) return;var $automaticLinksList = $section.find('#automaticLinksList');var isMultipleReplaces = false;if ( $automaticLinksList.length === 0 ) return;var keywords = tryParseJSON($automaticLinksList.val());if ( $section.data('is-multiple-replaces') ) {isMultipleReplaces = true;}
keywords = sortKeywords(keywords);$('.s123-editor').html(automaticLinkBuilding($('.s123-editor').html(), keywords));function automaticLinkBuilding(content, keywords) {var tempDiv = $('<div>').html(content);tempDiv.contents().each(function() {processTextNodes(this);});return tempDiv.html();}
function processTextNodes(node) {if (node.nodeType === Node.TEXT_NODE) {var text = node.nodeValue;var newText = text;for (var keyword in keywords) {if ( keywords[keyword].length == 0 ) continue;var regex = new RegExp('(?<!<a[^>]*>)(?<!\\S)' + keyword + '(?!\\S)(?![^<]*</a>)', isMultipleReplaces ? 'giu' : 'iu');newText = newText.replace(regex, function(match) {if ( keywords[keyword].length == 0 ) return match;var link = '<a href="' + keywords[keyword] + '">' + match + '</a>';if ( !isMultipleReplaces ) keywords[keyword] = '';return link;});}
if (newText !== text) {$(node).replaceWith(newText);}} else {if (node.nodeType === Node.ELEMENT_NODE && !$(node).is('img') && !$(node).is('a') && !$(node).is('h1') && !$(node).is('h2') && !$(node).is('h3') && !$(node).is('iframe')) {$(node).contents().each(function() {processTextNodes(this);});}}}
function tryParseJSON( str ) {try {var Obj = JSON.parse(str);if ( Obj && typeof Obj === "object" ) {return Obj;}} catch (e) {}
return false;}
function sortKeywords( keywords ) {var sortedKeywords = Object.entries(keywords);sortedKeywords.sort((a, b) => b[0].length - a[0].length);return Object.fromEntries(sortedKeywords);}}var PortfolioImagesPreloader = function() {var _ = {className: 'img-s-h-processed'};_.init = function( settings ) {_.$elements = settings.$elements;processAll();};_.refresh = function() {processAll();};function processAll() {_.$elements.each(function( index, el ) {var aspectRatio = $(this).data('ratio');if ( !$.isNumeric(aspectRatio) ) return;processSize($(this),aspectRatio);});}
function processSize( $el, aspectRatio ) {if ( $el.data('add-def-size') === 'height' ) {var width = $el.width();if ( width === 0 ) return;$el.css({height: ( width / aspectRatio )});} else {var height = $el.height();if ( height === 0 ) return;$el.css({width: ( height * aspectRatio )});}
$el.addClass(_.className);}
return _;}();var portfolioPasswordForm = function() {var $passwordForm = $('section.s123-page-data-portfolio #portfolioPasswordForm');if ( $passwordForm.length === 0 ) return;$passwordForm.validate({errorElement: 'div',errorClass: 'help-block',focusInvalid: true,ignore: "",highlight: function (e) {$(e).closest('.form-group').removeClass('has-info').addClass('has-error');},success: function (e) {$(e).closest('.form-group').removeClass('has-error');$(e).remove();},submitHandler: function( form ) {$passwordForm.find('button:submit').prop('disabled', true);$.ajax({type: 'POST',url: '/versions/'+$(versionNUM).val()+'/wizard/modules/portfolio/include/login.php',data: $passwordForm.serialize(),success: function( data ) {var data = jQuery.parseJSON(data);if ( data.status == 'ok' ) {window.location.reload();} else if ( data.status == 'wrongPassword' ) {$passwordForm.find('.form-group').addClass('has-error').append('<div id="p-error" class="help-block">' + data.errMsg + '</div>');$passwordForm.find('button:submit').prop('disabled',false);}}});}});}();jQuery(function($) {$(document).on('s123.page.ready_data_pages', function( event ) {PortfolioInitialize_Data1();});PortfolioInitialize_Data1();});function PortfolioInitialize_Data1() {var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data-portfolio.data-1');if ( $section.length === 0 ) return;PortfolioImagesPreloader.init({$elements: $section.find('img.lazyload[data-add-def-size]')});$section.find('.portfolio-section').each(function( index, section ) {var $sectionThis = $(this);$sectionThis.magnificPopup({fixedContentPos: true,mainClass: 'mfp-module-portfolio disable-context-menu', // Popup classes
delegate: '.mfp-image:visible',						// Images selectors
closeOnContentClick: true,closeBtnInside: false,tLoading: translations.loading,						// Text that is displayed during loading
gallery: {enabled: true,tClose: translations.closeEsc,					// Alt text on close button
tPrev: translations.previousLeftArrowKey,		// Alt text on left arrow
tNext: translations.NextRightArrowKey,			// Alt text on right arrow
tCounter: '%curr% '+translations.of+' %total%'	// Markup for "1 of 7" counter
},image: {markup: '<div class="mfp-figure">'+'<div class="mfp-close"></div>'+'<div class="mfp-img"></div>'+'<div class="mfp-bottom-bar fancy-scrollbar">'+'<div class="mfp-title"></div>'+'<div class="mfp-counter"></div>'+'<span class="mfp-caption-close">'+S123.s123IconToSvg.getHtml('times','','')+'</span>'+'</div>'+'</div>',tError: translations.imageCouldNotLoaded		// Error message when image could not be loaded
},iframe: {markup: '<div class="mfp-iframe-scaler">' +'<div class="mfp-close"></div>' +'<iframe class="mfp-iframe" frameborder="0" allowfullscreen></iframe>' +'<div class="mfp-title" style="position: absolute; padding-top: 5px;"></div>' +'</div>',patterns: {site123: {index: $GLOBALS['cdn-user-videos-files'],id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'},site123Processing: {index: '/files/images/video-processing.png',id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'}}},callbacks: {elementParse: function( item ) {if ( item.el.data('type') === 'video' ) {item.type = 'iframe';} else {item.type = 'image';}},updateStatus: function( data ) {var $bar = $('.mfp-bottom-bar');var $close = $('.mfp-caption-close');$bar.show();$close.off('click').on('click',function( event ) {event.stopPropagation();$bar.hide();});$bar.height() > 50 ? $close .show() : $close .hide();},open: function( item ) {var mc = new Hammer(this.container.get(0));mc.on('swipeleft', function(){$.magnificPopup.instance.next();});mc.on('swiperight', function(){$.magnificPopup.instance.prev();});$sectionThis.data('hammer-js',mc);$(document).trigger('s123.page.ready.ReplaceExternalLinksInFreeSubDomain');},change: function() {if ( this.isOpen ) {this.wrap.addClass('mfp-open');}},close: function( item ) {$sectionThis.data('hammer-js').destroy();}}});});if ( IsWizard() ) {$(document).off('wizard.preview.device.changed.portfolio_handler').on('wizard.preview.device.changed.portfolio_handler', function (event) {PortfolioImagesPreloader.refresh();});}}jQuery(function($) {$(document).on('s123.page.ready_data_pages', function( event ) {PortfolioInitialize_Data2();});PortfolioInitialize_Data2();});function PortfolioInitialize_Data2() {var rtl = $('html[dir=rtl]').length === 1;var $section = $('section.s123-page-data-portfolio.data-2');if ( $section.length === 0 ) return;setImageSize($section);PortfolioImagesPreloader.init({$elements: $section.find('img.lazyload[data-add-def-size]')});$section.find('.portfolio-section').each(function( index, section ) {var $sectionThis = $(this);$sectionThis.find('.portfolio-items').isotope({itemSelector: '.p-image-wrapper'});$sectionThis.magnificPopup({fixedContentPos: true,mainClass: 'mfp-module-portfolio disable-context-menu', // Popup classes
delegate: '.mfp-image:visible',						// Images selectors
closeOnContentClick: true,closeBtnInside: false,tLoading: translations.loading,						// Text that is displayed during loading
gallery: {enabled: true,tClose: translations.closeEsc,					// Alt text on close button
tPrev: translations.previousLeftArrowKey,		// Alt text on left arrow
tNext: translations.NextRightArrowKey,			// Alt text on right arrow
tCounter: '%curr% '+translations.of+' %total%'	// Markup for "1 of 7" counter
},image: {markup: '<div class="mfp-figure">'+'<div class="mfp-close"></div>'+'<div class="mfp-img"></div>'+'<div class="mfp-bottom-bar fancy-scrollbar">'+'<div class="mfp-title"></div>'+'<div class="mfp-counter"></div>'+'<span class="mfp-caption-close">'+S123.s123IconToSvg.getHtml('times','','')+'</span>'+'</div>'+'</div>',tError: translations.imageCouldNotLoaded		// Error message when image could not be loaded
},iframe: {markup: '<div class="mfp-iframe-scaler">' +'<div class="mfp-close"></div>' +'<iframe class="mfp-iframe" frameborder="0" allowfullscreen></iframe>' +'<div class="mfp-title" style="position: absolute; padding-top: 5px;"></div>' +'</div>',patterns: {site123: {index: $GLOBALS['cdn-user-videos-files'],id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'},site123Processing: {index: '/files/images/video-processing.png',id: function( url ) {if ( isMobileDevice.any() ) url += '&autoplay=0';return url;},src: '/include/globalVideoPlayer.php?websiteID='+$('#websiteID').val()+'&website_uniqueID='+$('#website_uniqueID').val()+'&cad=1&url=%id%'}}},callbacks: {elementParse: function( item ) {if ( item.el.data('type') === 'video' ) {item.type = 'iframe';} else {item.type = 'image';}},updateStatus: function( data ) {var $bar = $('.mfp-bottom-bar');var $close = $('.mfp-caption-close');$bar.show();$close.off('click').on('click',function( event ) {event.stopPropagation();$bar.hide();});$bar.height() > 50 ? $close .show() : $close .hide();},open: function( item ) {var mc = new Hammer(this.container.get(0));mc.on('swipeleft', function(){$.magnificPopup.instance.next();});mc.on('swiperight', function(){$.magnificPopup.instance.prev();});$sectionThis.data('hammer-js',mc);$(document).trigger('s123.page.ready.ReplaceExternalLinksInFreeSubDomain');},change: function() {if ( this.isOpen ) {this.wrap.addClass('mfp-open');}},close: function( item ) {$sectionThis.data('hammer-js').destroy();}}});});$(document).off('lazyload_enter.image.portfolio').on('lazyload_enter.image.portfolio',function( event, $img ) {if ( $img.hasClass('img-s-h-processed') ) return;var $galleryItemWrapper = $img.closest('.p-image-wrapper');$galleryItemWrapper.imagesLoaded().progress( function( instance, image ) {$galleryItemWrapper.closest('.portfolio-items').isotope('layout');});});if ( IsWizard() ) {$(document).off('wizard.preview.device.changed.portfolio_handler').on('wizard.preview.device.changed.portfolio_handler', function (event) {setImageSize($section);PortfolioImagesPreloader.refresh();});}
function decideNumberOfImageByScreenWidth( $itemsContainer ) {var screen = $itemsContainer.width();if ( screen <= 400 ) {return 1;}
if ( screen <= 768 ) {return 2;}
if ( screen <= 992 ) {return 3;}
if ( screen <= 1600 ) {return 3;}
if ( screen > 1600 ) {return 4;}}
function setImageSize( $section ) {$section.find('.portfolio-section').each(function( index, section ) {var $itemsContainer = $(this).find('.portfolio-items');var imageWidth = Math.floor($itemsContainer.width()/decideNumberOfImageByScreenWidth($itemsContainer));imageWidth -= 10;$itemsContainer.find('.p-image-wrapper').width(imageWidth);});}}jQuery(function($) {$( document ).on( 's123.page.ready_data_pages', function( event ) {onlineCoursesDataPageInit();});onlineCoursesDataPageInit();});function onlineCoursesDataPageInit() {var $section = $('section.s123-page-data-online-courses');if ( $section.length === 0 ) return;onlineCoursesInit($section);}// Run when the page ready (before images and other resource)
jQuery(function($) {$(document).on('s123.page.ready_data_pages', function(event) {teamDataPageInit();});teamDataPageInit();});function teamDataPageInit() {var $section = $('section.s123-page-data.s123-page-data-team');if ( $section.length === 0 ) return;$section.find('.team-phone-btn').click(function() {var $this = $(this);var $teamPhone = $this.closest('.team-phone');buildPopup('teamPopupFloatDivPhone','',$teamPhone.find('.team-phone-popover').html(),'',true,true,true,'','');});}function TriggerS123PageReadyData() {$( document ).trigger('s123.page.ready_data_pages');}